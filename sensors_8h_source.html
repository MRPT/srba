<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SRBA: Sparser Relative Bundle Adjustment: srba/models/sensors.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SRBA: Sparser Relative Bundle Adjustment
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">srba/models/sensors.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* +---------------------------------------------------------------------------+</span>
<a name="l00002"></a>00002 <span class="comment">   |                     Mobile Robot Programming Toolkit (MRPT)               |</span>
<a name="l00003"></a>00003 <span class="comment">   |                          http://www.mrpt.org/                             |</span>
<a name="l00004"></a>00004 <span class="comment">   |                                                                           |</span>
<a name="l00005"></a>00005 <span class="comment">   | Copyright (c) 2005-2015, Individual contributors, see AUTHORS file        |</span>
<a name="l00006"></a>00006 <span class="comment">   | See: http://www.mrpt.org/Authors - All rights reserved.                   |</span>
<a name="l00007"></a>00007 <span class="comment">   | Released under BSD License. See details in http://www.mrpt.org/License    |</span>
<a name="l00008"></a>00008 <span class="comment">   +---------------------------------------------------------------------------+ */</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#pragma once</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_pose3_d_quat_8h.html">mrpt/poses/CPose3DQuat.h</a>&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">namespace </span>srba {
<a name="l00023"></a>00023     <span class="keyword">template</span> &lt;&gt;
<a name="l00024"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html">00024</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean3D,observations::MonocularCamera&gt;
<a name="l00025"></a>00025     {
<a name="l00026"></a>00026         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00027"></a>00027         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00028"></a>00028         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00029"></a>00029         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00030"></a>00030         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1MonocularCamera.html">observations::MonocularCamera</a>  <a class="code" href="structsrba_1_1observations_1_1MonocularCamera.html">OBS_T</a>;  
<a name="l00031"></a>00031         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">landmarks::Euclidean3D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">LANDMARK_T</a>;
<a name="l00032"></a>00032         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00035"></a>00035         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00036"></a>00036         
<a name="l00037"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#a5a02864b38e612198c032d4cfa6aa827">00037</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#a5a02864b38e612198c032d4cfa6aa827" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00038"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#acbaa5928e691c79bcc589b2186d16e1e">00038</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#acbaa5928e691c79bcc589b2186d16e1e" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00039"></a>00039         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1MonocularCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1MonocularCamera_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00049"></a>00049         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00050"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#afae69aa0a90e8ee8d52df7ac2c1643cb">00050</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00051"></a>00051             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00052"></a>00052             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00053"></a>00053             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00054"></a>00054             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00055"></a>00055             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1MonocularCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00056"></a>00056         {
<a name="l00057"></a>00057             <span class="keywordtype">double</span> x,y,z; <span class="comment">// wrt cam (local coords)</span>
<a name="l00058"></a>00058             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1],lm_pos[2], x,y,z);
<a name="l00059"></a>00059             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#a47eb5a445c2bf3d9190396510ea9683e">ASSERT_</a>(z!=0)
<a name="l00060"></a>00060 
<a name="l00061"></a>00061             <span class="comment">// Pinhole model:</span>
<a name="l00062"></a>00062             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00063"></a>00063             pred_obs[0] = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#abe3a3d34f75e8dd554a9bf52c9ab6626">cx</a>() + params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>() * x/z;
<a name="l00064"></a>00064             pred_obs[1] = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#aaeba6c9dc0e4259ec9d435429c4a9e6e">cy</a>() + params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>() * y/z;
<a name="l00065"></a>00065             out_obs_err = z_obs - pred_obs;
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067 
<a name="l00085"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#a29fd605e7b09293f4b6d9e5e19a4b8c6">00085</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00086"></a>00086             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#a5a02864b38e612198c032d4cfa6aa827" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00087"></a>00087             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00088"></a>00088             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1MonocularCamera_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00089"></a>00089         {
<a name="l00090"></a>00090             <span class="comment">// xji_l[0:2]=[X Y Z]</span>
<a name="l00091"></a>00091             <span class="comment">// If the point is behind us, mark this Jacobian as invalid. This is probably a temporary situation until we get closer to the optimum.</span>
<a name="l00092"></a>00092             <span class="keywordflow">if</span> (xji_l[2]&lt;=0)
<a name="l00093"></a>00093                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095             <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv = 1.0/xji_l[2];
<a name="l00096"></a>00096             <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv2 = pz_inv*pz_inv;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098             <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fx = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>();
<a name="l00099"></a>00099             <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fy = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>();
<a name="l00100"></a>00100 
<a name="l00101"></a>00101             dh_dx.coeffRef(0,0)=  cam_fx * pz_inv;
<a name="l00102"></a>00102             dh_dx.coeffRef(0,1)=  0;
<a name="l00103"></a>00103             dh_dx.coeffRef(0,2)=  -cam_fx * xji_l[0] * pz_inv2;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105             dh_dx.coeffRef(1,0)=  0;
<a name="l00106"></a>00106             dh_dx.coeffRef(1,1)=  cam_fy * pz_inv;
<a name="l00107"></a>00107             dh_dx.coeffRef(1,2)=  -cam_fy * xji_l[1] * pz_inv2;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00110"></a>00110         }
<a name="l00111"></a>00111 
<a name="l00121"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1MonocularCamera_01_4.html#a39fdb59e0fa7bda39def00c1927e63a6">00121</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00122"></a>00122             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00123"></a>00123             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00124"></a>00124             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1MonocularCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00125"></a>00125         {
<a name="l00126"></a>00126             <span class="comment">//     &gt; +Z </span>
<a name="l00127"></a>00127             <span class="comment">//    / </span>
<a name="l00128"></a>00128             <span class="comment">//   / </span>
<a name="l00129"></a>00129             <span class="comment">//  +----&gt; +X</span>
<a name="l00130"></a>00130             <span class="comment">//  |</span>
<a name="l00131"></a>00131             <span class="comment">//  |</span>
<a name="l00132"></a>00132             <span class="comment">//  V +Y</span>
<a name="l00133"></a>00133             <span class="comment">//</span>
<a name="l00134"></a>00134             <span class="keyword">const</span> <span class="keywordtype">double</span> fx = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>();
<a name="l00135"></a>00135             <span class="keyword">const</span> <span class="keywordtype">double</span> fy = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>();
<a name="l00136"></a>00136             <span class="keyword">const</span> <span class="keywordtype">double</span> cx = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#abe3a3d34f75e8dd554a9bf52c9ab6626">cx</a>();
<a name="l00137"></a>00137             <span class="keyword">const</span> <span class="keywordtype">double</span> cy = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#aaeba6c9dc0e4259ec9d435429c4a9e6e">cy</a>();
<a name="l00138"></a>00138             out_lm_pos[0] = (obs.px.x-cx)/fx;
<a name="l00139"></a>00139             out_lm_pos[1] = (obs.px.y-cy)/fy;
<a name="l00140"></a>00140             out_lm_pos[2] = 1; <span class="comment">// Depth in Z (undefined for monocular cameras, just use any !=0 value)</span>
<a name="l00141"></a>00141         }
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     };  <span class="comment">// end of struct sensor_model&lt;landmarks::Euclidean3D,observations::MonocularCamera&gt;</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00146"></a>00146 
<a name="l00148"></a>00148     <span class="keyword">template</span> &lt;&gt;
<a name="l00149"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html">00149</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean3D,observations::StereoCamera&gt;
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00152"></a>00152         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00153"></a>00153         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00154"></a>00154         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00155"></a>00155         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1StereoCamera.html">observations::StereoCamera</a>     <a class="code" href="structsrba_1_1observations_1_1StereoCamera.html">OBS_T</a>;  
<a name="l00156"></a>00156         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">landmarks::Euclidean3D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">LANDMARK_T</a>;
<a name="l00157"></a>00157         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00160"></a>00160         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00161"></a>00161         
<a name="l00162"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a1f5bb15356cffc3adaef0d42b05ecc0e">00162</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a1f5bb15356cffc3adaef0d42b05ecc0e" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00163"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a227347dd2a2ae6d1464584ad91497b89">00163</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a227347dd2a2ae6d1464584ad91497b89" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00164"></a>00164         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1StereoCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1StereoCamera_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 
<a name="l00174"></a>00174         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00175"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#aaefcabc43b4f3303a3c7fccceb2e49e2">00175</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00176"></a>00176             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00177"></a>00177             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00178"></a>00178             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00179"></a>00179             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00180"></a>00180             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1StereoCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00181"></a>00181         {
<a name="l00182"></a>00182             <span class="keywordtype">double</span> lx,ly,lz; <span class="comment">// wrt cam (local coords)</span>
<a name="l00183"></a>00183             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1],lm_pos[2], lx,ly,lz);
<a name="l00184"></a>00184             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#a47eb5a445c2bf3d9190396510ea9683e">ASSERT_</a>(lz!=0)
<a name="l00185"></a>00185 
<a name="l00186"></a>00186             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00187"></a>00187             <span class="comment">// Pinhole model: Left camera.</span>
<a name="l00188"></a>00188             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html">mrpt::utils::TCamera</a> &amp;lc = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>;
<a name="l00189"></a>00189             pred_obs[0] = lc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#abe3a3d34f75e8dd554a9bf52c9ab6626">cx</a>() + lc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>() * lx/lz;
<a name="l00190"></a>00190             pred_obs[1] = lc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#aaeba6c9dc0e4259ec9d435429c4a9e6e">cy</a>() + lc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>() * ly/lz;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192             <span class="comment">// Project point relative to right-camera:</span>
<a name="l00193"></a>00193             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html">mrpt::poses::CPose3DQuat</a> R2L = -params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a0f01f7be552b1ceca65687d5def9ee43">rightCameraPose</a>; <span class="comment">// R2L = (-) Left-to-right_camera_pose</span>
<a name="l00194"></a>00194             
<a name="l00195"></a>00195             <span class="comment">// base_wrt_right_cam = ( (-)L2R ) (+) L2Base</span>
<a name="l00196"></a>00196             <span class="comment">//mrpt::poses::CPose3DQuat base_wrt_right_cam(mrpt::poses::UNINITIALIZED_POSE);</span>
<a name="l00197"></a>00197             <span class="comment">//base_wrt_right_cam.composeFrom(R2L,mrpt::poses::CPose3DQuat(base_pose_wrt_observer));</span>
<a name="l00198"></a>00198             
<a name="l00199"></a>00199             <span class="keywordtype">double</span> rx,ry,rz; <span class="comment">// wrt cam (local coords)</span>
<a name="l00200"></a>00200             <span class="comment">//base_wrt_right_cam.composePoint(lx,ly,lz, rx,ry,rz);</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202             <span class="comment">// xji_l_right = R2L (+) Xji_l</span>
<a name="l00203"></a>00203             R2L.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html#a025c269ded507d15e44775d6adce7618">composePoint</a>(lx,ly,lz, rx,ry,rz);
<a name="l00204"></a>00204             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#a47eb5a445c2bf3d9190396510ea9683e">ASSERT_</a>(rz!=0)
<a name="l00205"></a>00205 
<a name="l00206"></a>00206             <span class="comment">// Pinhole model: Right camera.</span>
<a name="l00207"></a>00207             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html">mrpt::utils::TCamera</a> &amp;rc = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a165a2ecc5395109501116c51641140c0">rightCamera</a>;
<a name="l00208"></a>00208             pred_obs[2] = rc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#abe3a3d34f75e8dd554a9bf52c9ab6626">cx</a>() + rc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>() * rx/rz;
<a name="l00209"></a>00209             pred_obs[3] = rc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#aaeba6c9dc0e4259ec9d435429c4a9e6e">cy</a>() + rc.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>() * ry/rz;
<a name="l00210"></a>00210             out_obs_err = z_obs - pred_obs;
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212 
<a name="l00230"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a650a3146c9f5eb3042591a2bf136d113">00230</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00231"></a>00231             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a1f5bb15356cffc3adaef0d42b05ecc0e" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00232"></a>00232             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00233"></a>00233             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1StereoCamera_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00234"></a>00234         {
<a name="l00235"></a>00235             <span class="comment">// xji_l[0:2]=[X Y Z]</span>
<a name="l00236"></a>00236             <span class="comment">// If the point is behind us, mark this Jacobian as invalid. This is probably a temporary situation until we get closer to the optimum.</span>
<a name="l00237"></a>00237             <span class="keywordflow">if</span> (xji_l[2]&lt;=0)
<a name="l00238"></a>00238                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00239"></a>00239             
<a name="l00240"></a>00240             <span class="comment">// Left camera:</span>
<a name="l00241"></a>00241             {
<a name="l00242"></a>00242                 <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv = 1.0/xji_l[2];
<a name="l00243"></a>00243                 <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv2 = pz_inv*pz_inv;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245                 <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fx = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>();
<a name="l00246"></a>00246                 <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fy = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>();
<a name="l00247"></a>00247 
<a name="l00248"></a>00248                 dh_dx.coeffRef(0,0)=  cam_fx * pz_inv;
<a name="l00249"></a>00249                 dh_dx.coeffRef(0,1)=  0;
<a name="l00250"></a>00250                 dh_dx.coeffRef(0,2)=  -cam_fx * xji_l[0] * pz_inv2;
<a name="l00251"></a>00251 
<a name="l00252"></a>00252                 dh_dx.coeffRef(1,0)=  0;
<a name="l00253"></a>00253                 dh_dx.coeffRef(1,1)=  cam_fy * pz_inv;
<a name="l00254"></a>00254                 dh_dx.coeffRef(1,2)=  -cam_fy * xji_l[1] * pz_inv2;
<a name="l00255"></a>00255             }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257             <span class="comment">// Right camera:</span>
<a name="l00258"></a>00258             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   xji_l_right; <span class="comment">// xji_l_right = R2L (+) Xji_l</span>
<a name="l00259"></a>00259             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html">mrpt::poses::CPose3DQuat</a> R2L = -sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a0f01f7be552b1ceca65687d5def9ee43">rightCameraPose</a>; <span class="comment">// R2L = (-) Left-to-right_camera_pose</span>
<a name="l00260"></a>00260             R2L.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html#a025c269ded507d15e44775d6adce7618">composePoint</a>(
<a name="l00261"></a>00261                 xji_l[0],xji_l[1],xji_l[2],
<a name="l00262"></a>00262                 xji_l_right[0],xji_l_right[1],xji_l_right[2]);
<a name="l00263"></a>00263             {
<a name="l00264"></a>00264                 <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv = 1.0/xji_l_right[2];
<a name="l00265"></a>00265                 <span class="keyword">const</span> <span class="keywordtype">double</span> pz_inv2 = pz_inv*pz_inv;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267                 <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fx = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a165a2ecc5395109501116c51641140c0">rightCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>();
<a name="l00268"></a>00268                 <span class="keyword">const</span> <span class="keywordtype">double</span> cam_fy = sensor_params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a165a2ecc5395109501116c51641140c0">rightCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>();
<a name="l00269"></a>00269 
<a name="l00270"></a>00270                 dh_dx.coeffRef(2,0)=  cam_fx * pz_inv;
<a name="l00271"></a>00271                 dh_dx.coeffRef(2,1)=  0;
<a name="l00272"></a>00272                 dh_dx.coeffRef(2,2)=  -cam_fx * xji_l_right[0] * pz_inv2;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274                 dh_dx.coeffRef(3,0)=  0;
<a name="l00275"></a>00275                 dh_dx.coeffRef(3,1)=  cam_fy * pz_inv;
<a name="l00276"></a>00276                 dh_dx.coeffRef(3,2)=  -cam_fy * xji_l_right[1] * pz_inv2;
<a name="l00277"></a>00277             }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281 
<a name="l00291"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1StereoCamera_01_4.html#a94257fc24e67147cd92aa1a99bd891af">00291</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00292"></a>00292             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00293"></a>00293             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00294"></a>00294             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1StereoCamera_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296             <span class="comment">//     &gt; +Z </span>
<a name="l00297"></a>00297             <span class="comment">//    / </span>
<a name="l00298"></a>00298             <span class="comment">//   / </span>
<a name="l00299"></a>00299             <span class="comment">//  +----&gt; +X</span>
<a name="l00300"></a>00300             <span class="comment">//  |</span>
<a name="l00301"></a>00301             <span class="comment">//  |</span>
<a name="l00302"></a>00302             <span class="comment">//  V +Y</span>
<a name="l00303"></a>00303             <span class="comment">//</span>
<a name="l00304"></a>00304             <span class="keyword">const</span> <span class="keywordtype">double</span> fxl = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a7566437233d844a551e3cce5effde1ea">fx</a>();
<a name="l00305"></a>00305             <span class="keyword">const</span> <span class="keywordtype">double</span> fyl = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#a75c5210381d62848b8c918a438991c55">fy</a>();
<a name="l00306"></a>00306             <span class="keyword">const</span> <span class="keywordtype">double</span> cxl = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#abe3a3d34f75e8dd554a9bf52c9ab6626">cx</a>();
<a name="l00307"></a>00307             <span class="keyword">const</span> <span class="keywordtype">double</span> cyl = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a8b421629a27e89293202a87f0adfe592">leftCamera</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_camera.html#aaeba6c9dc0e4259ec9d435429c4a9e6e">cy</a>();
<a name="l00308"></a>00308             <span class="keyword">const</span> <span class="keywordtype">double</span> disparity = std::max(0.001f, obs.left_px.x - obs.right_px.x);
<a name="l00309"></a>00309             <span class="keyword">const</span> <span class="keywordtype">double</span> baseline  = params.camera_calib.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_t_stereo_camera.html#a0f01f7be552b1ceca65687d5def9ee43">rightCameraPose</a>.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose_or_point.html#a5def0ee1a4de8d741d42c4d1c8012afc">x</a>();
<a name="l00310"></a>00310             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#a47eb5a445c2bf3d9190396510ea9683e">ASSERT_</a>(baseline!=0)
<a name="l00311"></a>00311             <span class="keyword">const</span> <span class="keywordtype">double</span> Z = fxl*baseline/disparity;
<a name="l00312"></a>00312             out_lm_pos[0] = (obs.left_px.x - cxl)*Z/fxl;
<a name="l00313"></a>00313             out_lm_pos[1] = (obs.left_px.y - cyl)*Z/fyl;
<a name="l00314"></a>00314             out_lm_pos[2] = Z;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     };  <span class="comment">// end of struct sensor_model&lt;landmarks::Euclidean3D,observations::StereoCamera&gt;</span>
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00320"></a>00320 
<a name="l00322"></a>00322     <span class="keyword">template</span> &lt;&gt;
<a name="l00323"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html">00323</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean3D,observations::Cartesian_3D&gt;
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00326"></a>00326         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00327"></a>00327         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00328"></a>00328         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00329"></a>00329         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D.html">observations::Cartesian_3D</a>     <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D.html">OBS_T</a>;  
<a name="l00330"></a>00330         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">landmarks::Euclidean3D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">LANDMARK_T</a>;
<a name="l00331"></a>00331         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00334"></a>00334         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00335"></a>00335         
<a name="l00336"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a5abbb1219c491e873e6eacb0ee776214">00336</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;        <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a5abbb1219c491e873e6eacb0ee776214" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00337"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#af8482def5a36ec580e86cb4c1cbb1eb5">00337</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#af8482def5a36ec580e86cb4c1cbb1eb5" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00338"></a>00338         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 
<a name="l00348"></a>00348         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00349"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a0149298889e9affe334c772e5e23e101">00349</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00350"></a>00350             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00351"></a>00351             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00352"></a>00352             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00353"></a>00353             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00354"></a>00354             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00357"></a>00357             <span class="keywordtype">double</span> x,y,z; <span class="comment">// wrt cam (local coords)</span>
<a name="l00358"></a>00358             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1],lm_pos[2], x,y,z);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00361"></a>00361             <span class="comment">// Observations are simply the &quot;local coords&quot;:</span>
<a name="l00362"></a>00362             pred_obs[0] = x; pred_obs[1] = y; pred_obs[2] = z;
<a name="l00363"></a>00363             out_obs_err = z_obs - pred_obs;
<a name="l00364"></a>00364         }
<a name="l00365"></a>00365 
<a name="l00383"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a59a59b1753eb4a5cb003f7ebeb2fb15d">00383</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00384"></a>00384             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a5abbb1219c491e873e6eacb0ee776214" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00385"></a>00385             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00386"></a>00386             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00387"></a>00387         {
<a name="l00388"></a>00388             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(xji_l); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00389"></a>00389             <span class="comment">// xji_l[0:2]=[X Y Z]</span>
<a name="l00390"></a>00390             <span class="comment">// This is probably the simplest Jacobian ever:</span>
<a name="l00391"></a>00391             dh_dx.setIdentity();
<a name="l00392"></a>00392             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394 
<a name="l00404"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1Cartesian__3D_01_4.html#a42e9776e301600f6676ad5734f70e877">00404</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00405"></a>00405             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00406"></a>00406             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00407"></a>00407             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00408"></a>00408         {
<a name="l00409"></a>00409             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00410"></a>00410             out_lm_pos[0] = obs.pt.x;
<a name="l00411"></a>00411             out_lm_pos[1] = obs.pt.y;
<a name="l00412"></a>00412             out_lm_pos[2] = obs.pt.z;
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     };  <span class="comment">// end of struct sensor_model&lt;landmarks::Euclidean3D,observations::Cartesian_3D&gt;</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00418"></a>00418 
<a name="l00420"></a>00420     <span class="keyword">template</span> &lt;&gt;
<a name="l00421"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html">00421</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean2D,observations::Cartesian_2D&gt;
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00424"></a>00424         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00425"></a>00425         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00426"></a>00426         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00427"></a>00427         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D.html">observations::Cartesian_2D</a>     <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D.html">OBS_T</a>;  
<a name="l00428"></a>00428         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean2D.html">landmarks::Euclidean2D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean2D.html">LANDMARK_T</a>;
<a name="l00429"></a>00429         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00432"></a>00432         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00433"></a>00433         
<a name="l00434"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#a9c164d2b6c12535fe03a6c0fc7c87e2e">00434</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#a9c164d2b6c12535fe03a6c0fc7c87e2e" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00435"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#ad17159c9e49a57ba63b40acf895656ba">00435</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#ad17159c9e49a57ba63b40acf895656ba" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00436"></a>00436         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 
<a name="l00446"></a>00446         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00447"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#a29298303563aa34e615dce56a69b4427">00447</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00448"></a>00448             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00449"></a>00449             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00450"></a>00450             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00451"></a>00451             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00452"></a>00452             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00453"></a>00453         {
<a name="l00454"></a>00454             <span class="keywordtype">double</span> x,y; <span class="comment">// wrt cam (local coords)</span>
<a name="l00455"></a>00455             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1], x,y);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00458"></a>00458             <span class="comment">// Observations are simply the &quot;local coords&quot;:</span>
<a name="l00459"></a>00459             pred_obs[0] = x; pred_obs[1] = y;
<a name="l00460"></a>00460             out_obs_err = z_obs - pred_obs;
<a name="l00461"></a>00461         }
<a name="l00462"></a>00462 
<a name="l00480"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#a4b620d6c73a779e0bfa474c5b85c2ced">00480</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00481"></a>00481             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#a9c164d2b6c12535fe03a6c0fc7c87e2e" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00482"></a>00482             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00483"></a>00483             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(xji_l); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00486"></a>00486             <span class="comment">// xji_l[0:1]=[X Y]</span>
<a name="l00487"></a>00487             <span class="comment">// This is probably the simplest Jacobian ever:</span>
<a name="l00488"></a>00488             dh_dx.setIdentity();
<a name="l00489"></a>00489             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491 
<a name="l00501"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1Cartesian__2D_01_4.html#aace12be3cd4da8c04cb99078869066b8">00501</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00502"></a>00502             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00503"></a>00503             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00504"></a>00504             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1Cartesian__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00505"></a>00505         {
<a name="l00506"></a>00506             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00507"></a>00507             out_lm_pos[0] = obs.pt.x;
<a name="l00508"></a>00508             out_lm_pos[1] = obs.pt.y;
<a name="l00509"></a>00509         }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     };  <span class="comment">// end of struct sensor_model&lt;landmarks::Euclidean2D,observations::Cartesian_2D&gt;</span>
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00514"></a>00514 
<a name="l00516"></a>00516     <span class="keyword">template</span> &lt;&gt;
<a name="l00517"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html">00517</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean3D,observations::RangeBearing_3D&gt;
<a name="l00518"></a>00518     {
<a name="l00519"></a>00519         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00520"></a>00520         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00521"></a>00521         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00522"></a>00522         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00523"></a>00523         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D.html">observations::RangeBearing_3D</a>  <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D.html">OBS_T</a>;  
<a name="l00524"></a>00524         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">landmarks::Euclidean3D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean3D.html">LANDMARK_T</a>;
<a name="l00525"></a>00525         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00528"></a>00528         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00529"></a>00529         
<a name="l00530"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#a8557c2188b55b7f43a439da8fcf09dca">00530</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#a8557c2188b55b7f43a439da8fcf09dca" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00531"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#abdffa7ffd5b722e7a5a99575557ceee4">00531</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#abdffa7ffd5b722e7a5a99575557ceee4" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00532"></a>00532         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 
<a name="l00542"></a>00542         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00543"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#adc26d77b114ce2f4ea539bef23e2a670">00543</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00544"></a>00544             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00545"></a>00545             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00546"></a>00546             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00547"></a>00547             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00548"></a>00548             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00549"></a>00549         {
<a name="l00550"></a>00550             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point3_d.html">mrpt::math::TPoint3D</a>  l; <span class="comment">// wrt sensor (local coords)</span>
<a name="l00551"></a>00551             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1],lm_pos[2], l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point3_d.html#a5014ee49d97866d293568300b619a7e2">x</a>,l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point3_d.html#aec879c0d61d8446e93b7d09344931d37">y</a>,l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point3_d.html#a61df04839b9146696e696fc7af3bc307">z</a>);
<a name="l00552"></a>00552             
<a name="l00553"></a>00553             <span class="keyword">static</span> <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d.html">mrpt::poses::CPose3D</a> origin;
<a name="l00554"></a>00554             <span class="keywordtype">double</span> range,yaw,<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/namespacemrpt_1_1obs_1_1gnss.html#a013273fbd6db260c79a236e097a68c10">pitch</a>;
<a name="l00555"></a>00555             origin.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d.html#af9ee4375107a49ffdebcd2ceb481fd68">sphericalCoordinates</a>(
<a name="l00556"></a>00556                 l,  <span class="comment">// In: point</span>
<a name="l00557"></a>00557                 range,yaw,pitch <span class="comment">// Out: spherical coords                            </span>
<a name="l00558"></a>00558                 );
<a name="l00559"></a>00559 
<a name="l00560"></a>00560             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00561"></a>00561             pred_obs[0] = range;
<a name="l00562"></a>00562             pred_obs[1] = yaw;
<a name="l00563"></a>00563             pred_obs[2] = pitch;
<a name="l00564"></a>00564             out_obs_err = z_obs - pred_obs;
<a name="l00565"></a>00565         }
<a name="l00566"></a>00566 
<a name="l00584"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#af1377f7528864b110743083f7454d584">00584</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00585"></a>00585             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#a8557c2188b55b7f43a439da8fcf09dca" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00586"></a>00586             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00587"></a>00587             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00588"></a>00588         {
<a name="l00589"></a>00589             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00590"></a>00590             <span class="comment">// xji_l[0:2]=[X Y Z]</span>
<a name="l00591"></a>00591             mrpt::math::CMatrixDouble33 dh_dx_(mrpt::math::UNINITIALIZED_MATRIX);
<a name="l00592"></a>00592 
<a name="l00593"></a>00593             <span class="keyword">static</span> <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html">mrpt::poses::CPose3DQuat</a> origin;
<a name="l00594"></a>00594             <span class="keywordtype">double</span> range,yaw,<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/namespacemrpt_1_1obs_1_1gnss.html#a013273fbd6db260c79a236e097a68c10">pitch</a>;
<a name="l00595"></a>00595             origin.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1poses_1_1_c_pose3_d_quat.html#ac86a1f27ec473abd1830835d5af5a109">sphericalCoordinates</a>(
<a name="l00596"></a>00596                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point3_d.html">mrpt::math::TPoint3D</a>(xji_l[0],xji_l[1],xji_l[2]),  <span class="comment">// In: point</span>
<a name="l00597"></a>00597                 range,yaw,pitch, <span class="comment">// Out: spherical coords</span>
<a name="l00598"></a>00598                 &amp;dh_dx_,   <span class="comment">// dh_dx</span>
<a name="l00599"></a>00599                 NULL       <span class="comment">// dh_dp (not needed)</span>
<a name="l00600"></a>00600                 );
<a name="l00601"></a>00601 
<a name="l00602"></a>00602             dh_dx = dh_dx_;
<a name="l00603"></a>00603             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00604"></a>00604         }
<a name="l00605"></a>00605 
<a name="l00615"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean3D_00_01observations_1_1RangeBearing__3D_01_4.html#a260b5fc1f1e459c3a77a53c6b86627f9">00615</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00616"></a>00616             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00617"></a>00617             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00618"></a>00618             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00619"></a>00619         {
<a name="l00620"></a>00620             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00621"></a>00621             <span class="keyword">const</span> <span class="keywordtype">double</span> chn_y = cos(obs.yaw),   shn_y = sin(obs.yaw);
<a name="l00622"></a>00622             <span class="keyword">const</span> <span class="keywordtype">double</span> chn_p = cos(obs.pitch), shn_p = sin(obs.pitch);
<a name="l00623"></a>00623             <span class="comment">// The new point, relative to the sensor:</span>
<a name="l00624"></a>00624             out_lm_pos[0] =  obs.range * chn_y * chn_p;
<a name="l00625"></a>00625             out_lm_pos[1] =  obs.range * shn_y * chn_p;
<a name="l00626"></a>00626             out_lm_pos[2] = -obs.range * shn_p;
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     };  <span class="comment">// end of struct sensor_model&lt;landmarks::Euclidean3D,observations::RangeBearing_3D&gt;</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00632"></a>00632 
<a name="l00634"></a>00634     <span class="keyword">template</span> &lt;&gt;
<a name="l00635"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html">00635</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::Euclidean2D,observations::RangeBearing_2D&gt;
<a name="l00636"></a>00636     {
<a name="l00637"></a>00637         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00638"></a>00638         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00639"></a>00639         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00640"></a>00640         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00641"></a>00641         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D.html">observations::RangeBearing_2D</a>  <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D.html">OBS_T</a>;  
<a name="l00642"></a>00642         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1Euclidean2D.html">landmarks::Euclidean2D</a>         <a class="code" href="structsrba_1_1landmarks_1_1Euclidean2D.html">LANDMARK_T</a>;
<a name="l00643"></a>00643         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00644"></a>00644 
<a name="l00645"></a>00645         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00646"></a>00646         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00647"></a>00647         
<a name="l00648"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a8d28cfdf45e3698c12b014738de20a90">00648</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a8d28cfdf45e3698c12b014738de20a90" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00649"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a910fe4fa2d3568d5f88701162d9be9b8">00649</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a910fe4fa2d3568d5f88701162d9be9b8" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00650"></a>00650         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 
<a name="l00660"></a>00660         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00661"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a9e3cdcadabf8fab23697a76828a68d6e">00661</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00662"></a>00662             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err,
<a name="l00663"></a>00663             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs,
<a name="l00664"></a>00664             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00665"></a>00665             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00666"></a>00666             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00667"></a>00667         {
<a name="l00668"></a>00668             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00669"></a>00669             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html">mrpt::math::TPoint2D</a>  l; <span class="comment">// wrt sensor (local coords)</span>
<a name="l00670"></a>00670             base_pose_wrt_observer.composePoint(lm_pos[0],lm_pos[1], l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a084825c8b4d02df7b89d66f8b08e26f2">x</a>,l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a1b6b3c44215ec8285ae97ff1ad1f6fcf">y</a>);
<a name="l00671"></a>00671             
<a name="l00672"></a>00672             <span class="keyword">const</span> <span class="keywordtype">double</span> range = hypot(l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a084825c8b4d02df7b89d66f8b08e26f2">x</a>,l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a1b6b3c44215ec8285ae97ff1ad1f6fcf">y</a>);
<a name="l00673"></a>00673             <span class="keyword">const</span> <span class="keywordtype">double</span> yaw   = atan2(l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a1b6b3c44215ec8285ae97ff1ad1f6fcf">y</a>,l.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1math_1_1_t_point2_d.html#a084825c8b4d02df7b89d66f8b08e26f2">x</a>);
<a name="l00674"></a>00674 
<a name="l00675"></a>00675             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>  pred_obs;  <span class="comment">// prediction</span>
<a name="l00676"></a>00676             pred_obs[0] = range;
<a name="l00677"></a>00677             pred_obs[1] = yaw;
<a name="l00678"></a>00678             out_obs_err = z_obs - pred_obs;
<a name="l00679"></a>00679         }
<a name="l00680"></a>00680 
<a name="l00698"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#aeec8650f3ec86784d390dba255974db7">00698</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00699"></a>00699             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#a8d28cfdf45e3698c12b014738de20a90" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00700"></a>00700             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l,
<a name="l00701"></a>00701             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00702"></a>00702         {
<a name="l00703"></a>00703             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00704"></a>00704             <span class="comment">// xji_l[0:1]=[X Y]</span>
<a name="l00705"></a>00705             <span class="keyword">const</span> <span class="keywordtype">double</span> r = hypot(xji_l[0], xji_l[1]);
<a name="l00706"></a>00706             <span class="keywordflow">if</span> (r==0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708             <span class="keyword">const</span> <span class="keywordtype">double</span> r_inv = 1.0/r;
<a name="l00709"></a>00709             <span class="keyword">const</span> <span class="keywordtype">double</span> r_inv2 = r_inv*r_inv;
<a name="l00710"></a>00710             dh_dx(0,0) = xji_l[0] * r_inv;
<a name="l00711"></a>00711             dh_dx(0,1) = xji_l[1] * r_inv;
<a name="l00712"></a>00712             dh_dx(1,0) = -xji_l[1] * r_inv2;
<a name="l00713"></a>00713             dh_dx(1,1) =  xji_l[0] * r_inv2;
<a name="l00714"></a>00714             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00715"></a>00715         }
<a name="l00716"></a>00716 
<a name="l00726"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1Euclidean2D_00_01observations_1_1RangeBearing__2D_01_4.html#ac8440145f352b0c288d2140e23cb3aa5">00726</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00727"></a>00727             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00728"></a>00728             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00729"></a>00729             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RangeBearing__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00730"></a>00730         {
<a name="l00731"></a>00731             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00732"></a>00732             <span class="keyword">const</span> <span class="keywordtype">double</span> chn_y = cos(obs.yaw), shn_y = sin(obs.yaw);
<a name="l00733"></a>00733             <span class="comment">// The new point, relative to the sensor:</span>
<a name="l00734"></a>00734             out_lm_pos[0] = obs.range * chn_y;
<a name="l00735"></a>00735             out_lm_pos[1] = obs.range * shn_y;
<a name="l00736"></a>00736         }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738     }; <span class="comment">// end of sensor_model&lt;landmarks::Euclidean2D,observations::RangeBearing_2D&gt;</span>
<a name="l00739"></a>00739 
<a name="l00740"></a>00740     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00741"></a>00741 
<a name="l00743"></a>00743     <span class="keyword">template</span> &lt;&gt;
<a name="l00744"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html">00744</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::RelativePoses2D,observations::RelativePoses_2D&gt;
<a name="l00745"></a>00745     {
<a name="l00746"></a>00746         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00747"></a>00747         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00748"></a>00748         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00749"></a>00749         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00750"></a>00750         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D.html">observations::RelativePoses_2D</a>  <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D.html">OBS_T</a>;  
<a name="l00751"></a>00751         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1RelativePoses2D.html">landmarks::RelativePoses2D</a>      <a class="code" href="structsrba_1_1landmarks_1_1RelativePoses2D.html">LANDMARK_T</a>;
<a name="l00752"></a>00752         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00755"></a>00755         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00756"></a>00756         
<a name="l00757"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a659001afb4244acdeb3075cbc33e444c">00757</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a659001afb4244acdeb3075cbc33e444c" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00758"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a85042d5a86c35a44b9a1c77c976359bd">00758</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a85042d5a86c35a44b9a1c77c976359bd" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00759"></a>00759         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 
<a name="l00769"></a>00769         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00770"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a83b9b7fe967b4d41451a245c16af9a55">00770</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00771"></a>00771             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00772"></a>00772             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00773"></a>00773             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00774"></a>00774             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00775"></a>00775             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00776"></a>00776         {
<a name="l00777"></a>00777             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(lm_pos); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00778"></a>00778             <span class="comment">// Relative pose observation: </span>
<a name="l00779"></a>00779             <span class="comment">//  OUT_OBS_ERR = - pseudo-log( PREDICTED_REL_POSE \ominus Z_OBS )</span>
<a name="l00780"></a>00780             <span class="keyword">const</span> POSE_T h = POSE_T(z_obs[0],z_obs[1],z_obs[2]) - base_pose_wrt_observer;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782             out_obs_err[0] = h.x();
<a name="l00783"></a>00783             out_obs_err[1] = h.y();
<a name="l00784"></a>00784             out_obs_err[2] = h.phi();
<a name="l00785"></a>00785         }
<a name="l00786"></a>00786 
<a name="l00804"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a18a0814b52fd9aa9d3367d6d62ae4c59">00804</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00805"></a>00805             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#a659001afb4244acdeb3075cbc33e444c" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00806"></a>00806             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00807"></a>00807             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00808"></a>00808         {
<a name="l00809"></a>00809             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(xji_l); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00810"></a>00810             <span class="comment">// h(z_obs \ominus p) = pseudo-log(z_obs \ominus  p)</span>
<a name="l00811"></a>00811             <span class="comment">// with p: relative pose in SE(2)</span>
<a name="l00812"></a>00812             dh_dx.setIdentity();
<a name="l00813"></a>00813             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00814"></a>00814         }
<a name="l00815"></a>00815 
<a name="l00825"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses2D_00_01observations_1_1RelativePoses__2D_01_4.html#ab5bdef8b23ca65de67279d7059cccab1">00825</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00826"></a>00826             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00827"></a>00827             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00828"></a>00828             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__2D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00829"></a>00829         {
<a name="l00830"></a>00830             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00831"></a>00831             out_lm_pos[0] = obs.x;
<a name="l00832"></a>00832             out_lm_pos[1] = obs.y;
<a name="l00833"></a>00833             out_lm_pos[2] = obs.yaw;
<a name="l00834"></a>00834         }
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     }; <span class="comment">// end of sensor_model&lt;landmarks::RelativePoses2D,observations::RelativePoses_2D&gt;</span>
<a name="l00837"></a>00837 
<a name="l00838"></a>00838     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00839"></a>00839 
<a name="l00841"></a>00841     <span class="keyword">template</span> &lt;&gt;
<a name="l00842"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html">00842</a>     <span class="keyword">struct </span>sensor_model&lt;landmarks::RelativePoses3D,observations::RelativePoses_3D&gt;
<a name="l00843"></a>00843     {
<a name="l00844"></a>00844         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00845"></a>00845         <span class="comment">// Typedefs for the sake of generality in the signature of methods below:</span>
<a name="l00846"></a>00846         <span class="comment">//   *DONT FORGET* to change these when writing new sensor models.</span>
<a name="l00847"></a>00847         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00848"></a>00848         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D.html">observations::RelativePoses_3D</a>  <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D.html">OBS_T</a>;  
<a name="l00849"></a>00849         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmarks_1_1RelativePoses3D.html">landmarks::RelativePoses3D</a>      <a class="code" href="structsrba_1_1landmarks_1_1RelativePoses3D.html">LANDMARK_T</a>;
<a name="l00850"></a>00850         <span class="comment">// --------------------------------------------------------------------------------</span>
<a name="l00851"></a>00851 
<a name="l00852"></a>00852         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS = OBS_T::OBS_DIMS;
<a name="l00853"></a>00853         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS  = LANDMARK_T::LM_DIMS;
<a name="l00854"></a>00854         
<a name="l00855"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a086cb70d7c46a7a6f84471e2a9b1697d">00855</a>         <span class="keyword">typedef</span> Eigen::Matrix&lt;double,OBS_DIMS,LM_DIMS&gt;  <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a086cb70d7c46a7a6f84471e2a9b1697d" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>;     
<a name="l00856"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a2b54d41b0c6204c093ff3839d9c30bfe">00856</a>         <span class="keyword">typedef</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a>    <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a2b54d41b0c6204c093ff3839d9c30bfe" title="a 2D or 3D point">array_landmark_t</a>;             
<a name="l00857"></a>00857         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D_1_1TObservationParams.html">TObservationParams</a>;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859 
<a name="l00867"></a>00867         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_T&gt;
<a name="l00868"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a7f45cfc9a8658369f27c63ed549e02b9">00868</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> observe_error(
<a name="l00869"></a>00869             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>              &amp; out_obs_err, 
<a name="l00870"></a>00870             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits&lt;OBS_T&gt;::array_obs_t</a>        &amp; z_obs, 
<a name="l00871"></a>00871             <span class="keyword">const</span> POSE_T                                        &amp; base_pose_wrt_observer,
<a name="l00872"></a>00872             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; lm_pos,
<a name="l00873"></a>00873             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>                     &amp; params)
<a name="l00874"></a>00874         {
<a name="l00875"></a>00875             <span class="comment">// Relative pose observation: </span>
<a name="l00876"></a>00876             <span class="comment">//  OUT_OBS_ERR = - pseudo-log( PREDICTED_REL_POSE \ominus Z_OBS )</span>
<a name="l00877"></a>00877             <span class="keyword">const</span> POSE_T h = POSE_T(z_obs[0],z_obs[1],z_obs[2],z_obs[3],z_obs[4],z_obs[5]) - base_pose_wrt_observer;
<a name="l00878"></a>00878 
<a name="l00879"></a>00879             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/structmrpt_1_1poses_1_1_s_e__traits_3_013_01_4.html#a718e1114dab1f44e3adf88e0e20005fe">mrpt::poses::SE_traits&lt;3&gt;::pseudo_ln</a>(h,out_obs_err);
<a name="l00880"></a>00880         }
<a name="l00881"></a>00881 
<a name="l00899"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#aac2095d7ee955db3bd6ae17ace5e03de">00899</a>         <span class="keyword">static</span> <span class="keywordtype">bool</span> eval_jacob_dh_dx(
<a name="l00900"></a>00900             <a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#a086cb70d7c46a7a6f84471e2a9b1697d" title="A Jacobian of the correct size for each dh_dx.">TJacobian_dh_dx</a>          &amp; dh_dx,
<a name="l00901"></a>00901             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>   &amp; xji_l, 
<a name="l00902"></a>00902             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D_1_1TObservationParams.html">TObservationParams</a> &amp; sensor_params)
<a name="l00903"></a>00903         {
<a name="l00904"></a>00904             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(xji_l); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(sensor_params);
<a name="l00905"></a>00905             <span class="comment">// h(z_obs \ominus p) = xji_l (the relative pose in SE(3)) </span>
<a name="l00906"></a>00906             dh_dx.setIdentity();
<a name="l00907"></a>00907             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909 
<a name="l00919"></a><a class="code" href="structsrba_1_1sensor__model_3_01landmarks_1_1RelativePoses3D_00_01observations_1_1RelativePoses__3D_01_4.html#afb5e0ff79e22eb98e6a97ea1692b57a9">00919</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> inverse_sensor_model(
<a name="l00920"></a>00920             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits&lt;LANDMARK_T&gt;::array_landmark_t</a> &amp; out_lm_pos,
<a name="l00921"></a>00921             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;OBS_T&gt;::obs_data_t</a>   &amp; obs, 
<a name="l00922"></a>00922             <span class="keyword">const</span> <a class="code" href="structsrba_1_1observations_1_1RelativePoses__3D_1_1TObservationParams.html">OBS_T::TObservationParams</a>               &amp; params)
<a name="l00923"></a>00923         {
<a name="l00924"></a>00924             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(params);
<a name="l00925"></a>00925             out_lm_pos[0] = obs.x;   out_lm_pos[1] = obs.y;     out_lm_pos[2] = obs.z;
<a name="l00926"></a>00926             out_lm_pos[3] = obs.yaw; out_lm_pos[4] = obs.pitch; out_lm_pos[5] = obs.roll; 
<a name="l00927"></a>00927         }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     };  <span class="comment">// end of struct sensor_model&lt;landmarks::RelativePoses3D,observations::RelativePoses_3D&gt;</span>
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     <span class="comment">// -------------------------------------------------------------------------------------------------------------</span>
<a name="l00932"></a>00932 
<a name="l00935"></a>00935 } <span class="comment">// end NS</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->


<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 13 2016 10:45:20 for SRBA: Sparser Relative Bundle Adjustment by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="$relpath^doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>


<script type="text/javascript">
var sc_project=10707328; 
var sc_invisible=1; 
var sc_security="34dd40cf"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web statistics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/10707328/0/34dd40cf/1/"
alt="web statistics"></a></div></noscript>

</body>
</html>
