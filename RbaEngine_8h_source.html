<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SRBA: Sparser Relative Bundle Adjustment: srba/RbaEngine.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SRBA: Sparser Relative Bundle Adjustment
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">srba/RbaEngine.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="RbaEngine_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* +---------------------------------------------------------------------------+</span>
<a name="l00002"></a>00002 <span class="comment">   |                     Mobile Robot Programming Toolkit (MRPT)               |</span>
<a name="l00003"></a>00003 <span class="comment">   |                          http://www.mrpt.org/                             |</span>
<a name="l00004"></a>00004 <span class="comment">   |                                                                           |</span>
<a name="l00005"></a>00005 <span class="comment">   | Copyright (c) 2005-2015, Individual contributors, see AUTHORS file        |</span>
<a name="l00006"></a>00006 <span class="comment">   | See: http://www.mrpt.org/Authors - All rights reserved.                   |</span>
<a name="l00007"></a>00007 <span class="comment">   | Released under BSD License. See details in http://www.mrpt.org/License    |</span>
<a name="l00008"></a>00008 <span class="comment">   +---------------------------------------------------------------------------+ */</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#pragma once</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_time_logger_8h.html">mrpt/utils/CTimeLogger.h</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_loadable_options_8h.html">mrpt/utils/CLoadableOptions.h</a>&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_set_of_objects_8h.html">mrpt/opengl/CSetOfObjects.h</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_pose3_d_quat_8h.html">mrpt/poses/CPose3DQuat.h</a>&gt;</span> <span class="comment">// Needed by &quot;CNetworkOfPoses.h&quot; in older mrpt versions</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/_c_network_of_poses_8h.html">mrpt/graphs/CNetworkOfPoses.h</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/os_8h.html">mrpt/system/os.h</a>&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/memory_8h.html">mrpt/system/memory.h</a>&gt;</span> <span class="comment">// MRPT_MAKE_ALIGNED_OPERATOR_NEW </span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;impl/make_ordered_list_base_kfs.h&quot;</span>  <span class="comment">// Internal aux function</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;srba_types.h&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;srba_options.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;srba_edge_creation_policies.h&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;landmark_jacob_families.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;landmark_matcher.h&quot;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">namespace </span>srba
<a name="l00032"></a>00032 {
<a name="l00039"></a><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html">00039</a>     <span class="keyword">struct </span><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html">RBA_OPTIONS_DEFAULT</a>
<a name="l00040"></a>00040     {
<a name="l00041"></a><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#aa37c742a7b0cb438271a85e5628e02ed">00041</a>         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1ecps_1_1local__areas__fixed__size.html">ecps::local_areas_fixed_size</a>            <a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#aa37c742a7b0cb438271a85e5628e02ed" title="One of the most important choices: how to construct the relative coordinates graph problem...">edge_creation_policy_t</a>;  
<a name="l00042"></a><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#af1b009b930cc63f3e2a0860d95bc621e">00042</a>         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1options_1_1sensor__pose__on__robot__none.html">options::sensor_pose_on_robot_none</a>      <a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#af1b009b930cc63f3e2a0860d95bc621e" title="The sensor pose coincides with the robot pose.">sensor_pose_on_robot_t</a>;  
<a name="l00043"></a><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#a65b9f09afe7cb7b662cdf3694fa19bdb">00043</a>         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1options_1_1observation__noise__identity.html">options::observation_noise_identity</a>     <a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#a65b9f09afe7cb7b662cdf3694fa19bdb" title="The sensor noise matrix is the same for all observations and equal to  * I(identity)">obs_noise_matrix_t</a>;      
<a name="l00044"></a><a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#a76451ffce0e942c4a224e275568a3f9b">00044</a>         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1options_1_1solver__LM__schur__dense__cholesky.html">options::solver_LM_schur_dense_cholesky</a> <a class="code" href="structsrba_1_1RBA__OPTIONS__DEFAULT.html#a76451ffce0e942c4a224e275568a3f9b" title="Solver algorithm (Default: Lev-Marq, with Schur, with dense Cholesky)">solver_t</a>;                
<a name="l00045"></a>00045     };
<a name="l00046"></a>00046 
<a name="l00066"></a>00066     <span class="keyword">template</span> &lt;<span class="keyword">class</span> KF2KF_POSE_TYPE,<span class="keyword">class</span> LM_TYPE,<span class="keyword">class</span> OBS_TYPE,<span class="keyword">class</span> RBA_OPTIONS = RBA_OPTIONS_DEFAULT&gt;
<a name="l00067"></a><a class="code" href="classsrba_1_1RbaEngine.html">00067</a>     <span class="keyword">class </span><a class="code" href="classsrba_1_1RbaEngine.html">RbaEngine</a>
<a name="l00068"></a>00068     {
<a name="l00069"></a>00069     <span class="keyword">public</span>:
<a name="l00072"></a>00072         <span class="keyword">typedef</span> <a class="code" href="classsrba_1_1RbaEngine.html">RbaEngine&lt;KF2KF_POSE_TYPE,LM_TYPE,OBS_TYPE,RBA_OPTIONS&gt;</a> <a class="code" href="classsrba_1_1RbaEngine.html">rba_engine_t</a>;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         <span class="keyword">typedef</span> KF2KF_POSE_TYPE  kf2kf_pose_t;
<a name="l00076"></a>00076         <span class="keyword">typedef</span> <a class="code" href="classLM__TYPE.html">LM_TYPE</a>          <a class="code" href="classLM__TYPE.html">landmark_t</a>;
<a name="l00077"></a>00077         <span class="keyword">typedef</span> OBS_TYPE         obs_t;
<a name="l00078"></a>00078         <span class="keyword">typedef</span> <a class="code" href="structRBA__OPTIONS.html" title="[includes_namespaces]">RBA_OPTIONS</a>      <a class="code" href="structRBA__OPTIONS.html" title="[includes_namespaces]">rba_options_t</a>;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> REL_POSE_DIMS = kf2kf_pose_t::REL_POSE_DIMS;
<a name="l00081"></a>00081         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> LM_DIMS       = landmark_t::LM_DIMS;
<a name="l00082"></a>00082         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> OBS_DIMS      = obs_t::OBS_DIMS;
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="classsrba_1_1RbaEngine.html#a8dc4ce69184134d8cb27c71ed8741a93">00084</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> kf2kf_pose_t::se_traits_t  <a class="code" href="classsrba_1_1RbaEngine.html#a8dc4ce69184134d8cb27c71ed8741a93" title="The SE(2) or SE(3) traits struct (for Lie algebra log/exp maps, etc.)">se_traits_t</a>; 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html">rba_joint_parameterization_traits_t&lt;kf2kf_pose_t,landmark_t,obs_t&gt;</a>  <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html">traits_t</a>;
<a name="l00087"></a>00087         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1jacobian__traits.html">jacobian_traits&lt;kf2kf_pose_t,landmark_t,obs_t&gt;</a>                      <a class="code" href="structsrba_1_1jacobian__traits.html">jacobian_traits_t</a>;
<a name="l00088"></a>00088         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1hessian__traits.html">hessian_traits&lt;kf2kf_pose_t,landmark_t,obs_t&gt;</a>                       <a class="code" href="structsrba_1_1hessian__traits.html">hessian_traits_t</a>;
<a name="l00089"></a>00089         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits.html">kf2kf_pose_traits&lt;kf2kf_pose_t&gt;</a>                                     <a class="code" href="structsrba_1_1kf2kf__pose__traits.html">kf2kf_pose_traits_t</a>;
<a name="l00090"></a>00090         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1landmark__traits.html">landmark_traits&lt;landmark_t&gt;</a>                                               <a class="code" href="structsrba_1_1landmark__traits.html">landmark_traits_t</a>;
<a name="l00091"></a>00091         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1observation__traits.html">observation_traits&lt;obs_t&gt;</a>                                           <a class="code" href="structsrba_1_1observation__traits.html">observation_traits_t</a>;
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="classsrba_1_1RbaEngine.html#ab14c53c9959f1c9934226bf38bef24ea">00093</a>         <span class="keyword">typedef</span> sensor_model&lt;landmark_t,obs_t&gt;   <a class="code" href="classsrba_1_1RbaEngine.html#ab14c53c9959f1c9934226bf38bef24ea" title="The sensor model for the specified combination of LM parameterization + observation type...">sensor_model_t</a>; 
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c">00095</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> kf2kf_pose_t::pose_t  <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a>; 
<a name="l00096"></a>00096         <span class="keyword">typedef</span> <a class="code" href="structsrba_1_1TRBA__Problem__state.html">TRBA_Problem_state&lt;KF2KF_POSE_TYPE,LM_TYPE,OBS_TYPE,RBA_OPTIONS&gt;</a> <a class="code" href="structsrba_1_1TRBA__Problem__state.html">rba_problem_state_t</a>;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">rba_problem_state_t::k2f_edge_t</a> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a>;
<a name="l00099"></a>00099         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html">rba_problem_state_t::k2k_edge_t</a> <a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html">k2k_edge_t</a>;
<a name="l00100"></a><a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b">00100</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> rba_problem_state_t::k2k_edges_deque_t  <a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b" title="A list (deque) of KF-to-KF edges (unknown relative poses).">k2k_edges_deque_t</a>;  
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         <span class="keyword">typedef</span> <span class="keyword">typename</span> kf2kf_pose_traits_t::pose_flag_t pose_flag_t;
<a name="l00103"></a>00103         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits.html#a5b7d4f6abdd0d906b1c9df326cf46347">kf2kf_pose_traits_t::frameid2pose_map_t</a>  frameid2pose_map_t;
<a name="l00104"></a>00104         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1map__as__vector.html">kf2kf_pose_traits_t::TRelativePosesForEachTarget</a> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1map__as__vector.html">TRelativePosesForEachTarget</a>;
<a name="l00105"></a><a class="code" href="classsrba_1_1RbaEngine.html#a7a58dde8b100c4cbd3181ffa30845971">00105</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1landmark__traits.html#a3eeade0c906e5d7c84aa830c557e0592">landmark_traits_t::TRelativeLandmarkPosMap</a> <a class="code" href="classsrba_1_1RbaEngine.html#a7a58dde8b100c4cbd3181ffa30845971" title="An index of feature IDs and their relative locations.">TRelativeLandmarkPosMap</a>;  
<a name="l00106"></a><a class="code" href="classsrba_1_1RbaEngine.html#ad9c684fcdf3f45f55baa7ce076fb1566">00106</a>         <span class="keyword">typedef</span> <span class="keyword">typename</span> landmark_traits_t::TRelativeLandmarkPos    <a class="code" href="classsrba_1_1RbaEngine.html#ad9c684fcdf3f45f55baa7ce076fb1566" title="One landmark position (relative to its base KF)">TRelativeLandmarkPos</a>; 
<a name="l00107"></a>00107         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1keyframe__info.html">traits_t::keyframe_info</a>   <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1keyframe__info.html">keyframe_info</a>;
<a name="l00108"></a>00108         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1new__kf__observation__t.html">traits_t::new_kf_observation_t</a>   <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1new__kf__observation__t.html">new_kf_observation_t</a>;
<a name="l00109"></a>00109         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html#a118ea54cd0d7342acef63c9fdcdad33e">traits_t::new_kf_observations_t</a>  new_kf_observations_t;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">kf2kf_pose_traits_t::array_pose_t</a>         <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_pose_t</a>;
<a name="l00112"></a>00112         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">landmark_traits_t::array_landmark_t</a>       <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a>;
<a name="l00113"></a>00113         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits_t::array_obs_t</a>         <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_obs_t</a>;
<a name="l00114"></a>00114         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">observation_traits_t::residual_t</a>          <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">residual_t</a>;
<a name="l00115"></a>00115         <span class="keyword">typedef</span> <span class="keyword">typename</span> observation_traits_t::vector_residuals_t  vector_residuals_t;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1jacobian__traits.html">jacobian_traits&lt;kf2kf_pose_t,landmark_t,obs_t&gt;::TSparseBlocksJacobians_dh_dAp</a> TSparseBlocksJacobians_dh_dAp;
<a name="l00118"></a>00118         <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1jacobian__traits.html">jacobian_traits&lt;kf2kf_pose_t,landmark_t,obs_t&gt;::TSparseBlocksJacobians_dh_df</a> TSparseBlocksJacobians_dh_df;
<a name="l00122"></a>00122         <a class="code" href="classsrba_1_1RbaEngine.html#a48c6eeea6c8f2505eb24e349ef532103">RbaEngine</a>();
<a name="l00123"></a>00123 
<a name="l00125"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">00125</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">TOptimizeExtraOutputInfo</a>
<a name="l00126"></a>00126         {
<a name="l00127"></a>00127             <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">TOptimizeExtraOutputInfo</a>()
<a name="l00128"></a>00128             {
<a name="l00129"></a>00129                 clear();
<a name="l00130"></a>00130             }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ab22c900efb14e03f0385e3bf61b36525">00132</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ab22c900efb14e03f0385e3bf61b36525" title="Number of individual feature observations taken into account in the optimization.">num_observations</a>;     
<a name="l00133"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a29d4796c303a197183e43ad026467d75">00133</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a29d4796c303a197183e43ad026467d75" title="Number of Jacobian blocks which had been to be evaluated for each relinearization step...">num_jacobians</a>;        
<a name="l00134"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aa67abbbb13063ca2b5e5cda1a189a6c2">00134</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aa67abbbb13063ca2b5e5cda1a189a6c2" title="Number of solved unknowns of type &quot;kf-to-kf edge&quot;.">num_kf2kf_edges_optimized</a>; 
<a name="l00135"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9d7b152516292eb2db2b85fb151d5271">00135</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9d7b152516292eb2db2b85fb151d5271" title="Number of solved unknowns of type &quot;kf-to-landmark&quot;.">num_kf2lm_edges_optimized</a>; 
<a name="l00136"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ac51fcc6915c14a1e51dddabf96b4de53">00136</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ac51fcc6915c14a1e51dddabf96b4de53" title="The total number of dimensions (scalar values) in all the optimized unknowns.">num_total_scalar_optimized</a>;  
<a name="l00137"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a1a1022a05fa65f4ea4ca19668f50c663">00137</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a1a1022a05fa65f4ea4ca19668f50c663" title="Number of individual keyframes taken into account in the optimization.">num_kf_optimized</a>;            
<a name="l00138"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aae07383abc83d225fc6331ec24422f38">00138</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aae07383abc83d225fc6331ec24422f38" title="Number of individual landmarks taken into account in the optimization.">num_lm_optimized</a>;            
<a name="l00139"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a0bc809b5e4098e17161b4313f00c60db">00139</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a0bc809b5e4098e17161b4313f00c60db" title="Number of poses updated in the spanning tree numeric-update stage.">num_span_tree_numeric_updates</a>; 
<a name="l00140"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aafd284cca197d4e35b9379fb5d54132c">00140</a>             <span class="keywordtype">double</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aafd284cca197d4e35b9379fb5d54132c" title="RMSE for each observation after optimization.">obs_rmse</a>; 
<a name="l00141"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a4898b99404dccff979788ec510508792">00141</a>             <span class="keywordtype">double</span>  total_sqr_error_init, <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a4898b99404dccff979788ec510508792" title="Initial and final total squared error for all the observations.">total_sqr_error_final</a>; 
<a name="l00142"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ae68597e4e9630827e9a82fd080e8a73e">00142</a>             <span class="keywordtype">double</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ae68597e4e9630827e9a82fd080e8a73e" title="To be computed only if enabled in parameters.compute_condition_number.">HAp_condition_number</a>; 
<a name="l00143"></a>00143 
<a name="l00147"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a91e900d969d48fe59a92e213dd8fc9b4">00147</a>             <span class="keywordtype">size_t</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a91e900d969d48fe59a92e213dd8fc9b4">sparsity_dh_dAp_nnz</a>, sparsity_dh_dAp_max_size, sparsity_dh_df_nnz, sparsity_dh_df_max_size, sparsity_HAp_nnz, sparsity_HAp_max_size,
<a name="l00148"></a>00148                     sparsity_Hf_nnz, sparsity_Hf_max_size, sparsity_HApf_nnz, sparsity_HApf_max_size;
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9a0cbed510c84e077105217ef92f01c9">00150</a>             std::vector&lt;size_t&gt; <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9a0cbed510c84e077105217ef92f01c9" title="The 0-based indices of all kf-to-kf edges which were considered in the optimization.">optimized_k2k_edge_indices</a>; 
<a name="l00151"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#af22d10e5aa51db34a8ffce72e31f0fad">00151</a>             std::vector&lt;size_t&gt; <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#af22d10e5aa51db34a8ffce72e31f0fad" title="The 0-based indices of all landmarks whose relative positions were considered as unknowns in the opti...">optimized_landmark_indices</a>; 
<a name="l00152"></a>00152 
<a name="l00154"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a7e69244798f15b8290defb18591e6e9e">00154</a>             <span class="keyword">typename</span> <a class="code" href="structsrba_1_1options_1_1solver__LM__schur__dense__cholesky_1_1extra__results__t.html">RBA_OPTIONS::solver_t::extra_results_t</a>   <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a7e69244798f15b8290defb18591e6e9e">extra_results</a>;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156             <span class="keywordtype">void</span> clear()
<a name="l00157"></a>00157             {
<a name="l00158"></a>00158                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ab22c900efb14e03f0385e3bf61b36525" title="Number of individual feature observations taken into account in the optimization.">num_observations</a> = 0;
<a name="l00159"></a>00159                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a29d4796c303a197183e43ad026467d75" title="Number of Jacobian blocks which had been to be evaluated for each relinearization step...">num_jacobians</a> = 0;
<a name="l00160"></a>00160                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aa67abbbb13063ca2b5e5cda1a189a6c2" title="Number of solved unknowns of type &quot;kf-to-kf edge&quot;.">num_kf2kf_edges_optimized</a> = 0;
<a name="l00161"></a>00161                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9d7b152516292eb2db2b85fb151d5271" title="Number of solved unknowns of type &quot;kf-to-landmark&quot;.">num_kf2lm_edges_optimized</a> = 0;
<a name="l00162"></a>00162                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ac51fcc6915c14a1e51dddabf96b4de53" title="The total number of dimensions (scalar values) in all the optimized unknowns.">num_total_scalar_optimized</a> = 0;
<a name="l00163"></a>00163                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a1a1022a05fa65f4ea4ca19668f50c663" title="Number of individual keyframes taken into account in the optimization.">num_kf_optimized</a> = 0;
<a name="l00164"></a>00164                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#aae07383abc83d225fc6331ec24422f38" title="Number of individual landmarks taken into account in the optimization.">num_lm_optimized</a> = 0;
<a name="l00165"></a>00165                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a0bc809b5e4098e17161b4313f00c60db" title="Number of poses updated in the spanning tree numeric-update stage.">num_span_tree_numeric_updates</a>=0;
<a name="l00166"></a>00166                 total_sqr_error_init=0.;
<a name="l00167"></a>00167                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a4898b99404dccff979788ec510508792" title="Initial and final total squared error for all the observations.">total_sqr_error_final</a>=0.;
<a name="l00168"></a>00168                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#ae68597e4e9630827e9a82fd080e8a73e" title="To be computed only if enabled in parameters.compute_condition_number.">HAp_condition_number</a>=0.;
<a name="l00169"></a>00169                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a91e900d969d48fe59a92e213dd8fc9b4">sparsity_dh_dAp_nnz</a> = sparsity_dh_dAp_max_size = sparsity_dh_df_nnz = sparsity_dh_df_max_size = 
<a name="l00170"></a>00170                 sparsity_HAp_nnz = sparsity_HAp_max_size = sparsity_Hf_nnz = sparsity_Hf_max_size =  sparsity_HApf_nnz = sparsity_HApf_max_size = 0;
<a name="l00171"></a>00171                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a9a0cbed510c84e077105217ef92f01c9" title="The 0-based indices of all kf-to-kf edges which were considered in the optimization.">optimized_k2k_edge_indices</a>.clear();
<a name="l00172"></a>00172                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#af22d10e5aa51db34a8ffce72e31f0fad" title="The 0-based indices of all landmarks whose relative positions were considered as unknowns in the opti...">optimized_landmark_indices</a>.clear();
<a name="l00173"></a>00173                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html#a7e69244798f15b8290defb18591e6e9e">extra_results</a>.clear();
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/memory_8h.html#ae8980bd7f8c37e72ce7763c5d94f0076">MRPT_MAKE_ALIGNED_OPERATOR_NEW</a>  <span class="comment">// Required by Eigen containers</span>
<a name="l00177"></a>00177         };
<a name="l00178"></a>00178 
<a name="l00180"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html">00180</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html">TNewKeyFrameInfo</a>
<a name="l00181"></a>00181         {
<a name="l00182"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a4de37d51406f602855d6258e72d9a363">00182</a>             TKeyFrameID                <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a4de37d51406f602855d6258e72d9a363" title="The ID of the newly created KF.">kf_id</a>;         
<a name="l00183"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a385006cd068816fc4feea6f38b9ef51c">00183</a>             std::vector&lt;TNewEdgeInfo&gt;  <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a385006cd068816fc4feea6f38b9ef51c" title="The newly created edges (minimum: 1 edge)">created_edge_ids</a>;  
<a name="l00184"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a7e305567a14a6e17a2e80e3c52dfea0e">00184</a>             <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">TOptimizeExtraOutputInfo</a>   <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a7e305567a14a6e17a2e80e3c52dfea0e" title="Results from the least-squares optimization.">optimize_results</a>;  
<a name="l00185"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a7bf956959b7e9653676e359f5c852558">00185</a>             <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">TOptimizeExtraOutputInfo</a>   <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a7bf956959b7e9653676e359f5c852558" title="Results from the least-squares optimization.">optimize_results_stg1</a>;  
<a name="l00186"></a>00186 
<a name="l00187"></a>00187             <span class="keywordtype">void</span> clear()
<a name="l00188"></a>00188             {
<a name="l00189"></a>00189                 <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a4de37d51406f602855d6258e72d9a363" title="The ID of the newly created KF.">kf_id</a> = <span class="keyword">static_cast&lt;</span>TKeyFrameID<span class="keyword">&gt;</span>(-1);
<a name="l00190"></a>00190                 <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a385006cd068816fc4feea6f38b9ef51c" title="The newly created edges (minimum: 1 edge)">created_edge_ids</a>.clear();
<a name="l00191"></a>00191                 <a class="code" href="structsrba_1_1RbaEngine_1_1TNewKeyFrameInfo.html#a7e305567a14a6e17a2e80e3c52dfea0e" title="Results from the least-squares optimization.">optimize_results</a>.clear();
<a name="l00192"></a>00192             }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/memory_8h.html#ae8980bd7f8c37e72ce7763c5d94f0076">MRPT_MAKE_ALIGNED_OPERATOR_NEW</a>  <span class="comment">// Required by Eigen containers</span>
<a name="l00195"></a>00195         };
<a name="l00196"></a>00196 
<a name="l00207"></a>00207         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#ac42b495132c3dc079bdfd3b51e402210">define_new_keyframe</a>(
<a name="l00208"></a>00208             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html#a118ea54cd0d7342acef63c9fdcdad33e">traits_t::new_kf_observations_t</a>  &amp; obs,
<a name="l00209"></a>00209             TNewKeyFrameInfo   &amp; out_new_kf_info,
<a name="l00210"></a>00210             <span class="keyword">const</span> <span class="keywordtype">bool</span>           run_local_optimization = <span class="keyword">true</span>
<a name="l00211"></a>00211             );
<a name="l00212"></a>00212 
<a name="l00214"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html">00214</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html">TOptimizeLocalAreaParams</a>
<a name="l00215"></a>00215         {
<a name="l00216"></a>00216             <span class="keywordtype">bool</span>        optimize_k2k_edges;
<a name="l00217"></a>00217             <span class="keywordtype">bool</span>        optimize_landmarks;
<a name="l00218"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a72b81ccf815e3f3788d342f56e70e9e6">00218</a>             TKeyFrameID <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a72b81ccf815e3f3788d342f56e70e9e6" title="While exploring around the root KF, stop the BFS when KF_ID&gt;=this number (default:infinity)">max_visitable_kf_id</a>; 
<a name="l00219"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a6a5549969928d7be769431494b3104d5">00219</a>             <span class="keywordtype">size_t</span>      <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a6a5549969928d7be769431494b3104d5" title="Set to 1 to try to optimize all landmarks even if they&#39;re just observed once, which may makes sense d...">dont_optimize_landmarks_seen_less_than_n_times</a>;  
<a name="l00220"></a>00220 
<a name="l00221"></a>00221             <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html">TOptimizeLocalAreaParams</a>() :
<a name="l00222"></a>00222                 optimize_k2k_edges(true),
<a name="l00223"></a>00223                 optimize_landmarks(true),
<a name="l00224"></a>00224                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a72b81ccf815e3f3788d342f56e70e9e6" title="While exploring around the root KF, stop the BFS when KF_ID&gt;=this number (default:infinity)">max_visitable_kf_id</a>( static_cast&lt;TKeyFrameID&gt;(-1) ),
<a name="l00225"></a>00225                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a6a5549969928d7be769431494b3104d5" title="Set to 1 to try to optimize all landmarks even if they&#39;re just observed once, which may makes sense d...">dont_optimize_landmarks_seen_less_than_n_times</a>( 2 )
<a name="l00226"></a>00226             {}
<a name="l00227"></a>00227         };
<a name="l00228"></a>00228 
<a name="l00235"></a>00235         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a4a764c69394055abe90b1f833b656855">optimize_local_area</a>(
<a name="l00236"></a>00236             <span class="keyword">const</span> TKeyFrameID  root_id,
<a name="l00237"></a>00237             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> win_size,
<a name="l00238"></a>00238             TOptimizeExtraOutputInfo &amp; out_info,
<a name="l00239"></a>00239             <span class="keyword">const</span> TOptimizeLocalAreaParams &amp;params = TOptimizeLocalAreaParams(),
<a name="l00240"></a>00240             <span class="keyword">const</span> std::vector&lt;size_t&gt; &amp; observation_indices_to_optimize = std::vector&lt;size_t&gt;()
<a name="l00241"></a>00241             );
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 
<a name="l00244"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html">00244</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html">TOpenGLRepresentationOptions</a> : <span class="keyword">public</span> <a class="code" href="classLM__TYPE.html">landmark_t</a>::render_mode_t::TOpenGLRepresentationOptionsExtra
<a name="l00245"></a>00245         {
<a name="l00246"></a>00246             <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html">TOpenGLRepresentationOptions</a>() :
<a name="l00247"></a>00247                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a6bef428efc94d1442ee3e98bb18ab054" title="Maximum spanning tree depth for reconstructing relative poses (default=std::numeric_limits&lt;size_t&gt;::m...">span_tree_max_depth</a>( std::numeric_limits&lt;size_t&gt;::max() ),
<a name="l00248"></a>00248                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a15acdaecd8a74565ef638adcf132f438" title="Draw features with non-fixed rel.pos as well?">draw_unknown_feats</a>(<span class="keyword">true</span>),
<a name="l00249"></a>00249                 draw_unknown_feats_ellipses(<span class="keyword">true</span>),
<a name="l00250"></a>00250                 draw_unknown_feats_ellipses_quantiles(1),
<a name="l00251"></a>00251                 show_unknown_feats_ids(<span class="keyword">true</span>),
<a name="l00252"></a>00252                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#ae2944700f847245044790a12d7c484fc" title="(default:false) Draw in a special way those KFs with more than one kf-to-kf edge, to help visualize t...">draw_kf_hierarchical</a>(<span class="keyword">false</span>),
<a name="l00253"></a>00253                 <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#acab1970f518ac4da531573b6bfd352a7" title="(default: 10.0) (If draw_kf_hierarchical==true) The height in Z to offset the &quot;border&quot; KFs...">draw_kf_hierarchical_height</a>(10.0)
<a name="l00254"></a>00254             {
<a name="l00255"></a>00255             }
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a6bef428efc94d1442ee3e98bb18ab054">00257</a>             <span class="keywordtype">size_t</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a6bef428efc94d1442ee3e98bb18ab054" title="Maximum spanning tree depth for reconstructing relative poses (default=std::numeric_limits&lt;size_t&gt;::m...">span_tree_max_depth</a>; 
<a name="l00258"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a15acdaecd8a74565ef638adcf132f438">00258</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#a15acdaecd8a74565ef638adcf132f438" title="Draw features with non-fixed rel.pos as well?">draw_unknown_feats</a>;  
<a name="l00259"></a>00259             <span class="keywordtype">bool</span>   draw_unknown_feats_ellipses;
<a name="l00260"></a>00260             <span class="keywordtype">double</span> draw_unknown_feats_ellipses_quantiles;
<a name="l00261"></a>00261             <span class="keywordtype">bool</span>   show_unknown_feats_ids;
<a name="l00262"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#ae2944700f847245044790a12d7c484fc">00262</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#ae2944700f847245044790a12d7c484fc" title="(default:false) Draw in a special way those KFs with more than one kf-to-kf edge, to help visualize t...">draw_kf_hierarchical</a>; 
<a name="l00263"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#acab1970f518ac4da531573b6bfd352a7">00263</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html#acab1970f518ac4da531573b6bfd352a7" title="(default: 10.0) (If draw_kf_hierarchical==true) The height in Z to offset the &quot;border&quot; KFs...">draw_kf_hierarchical_height</a>; 
<a name="l00264"></a>00264         };
<a name="l00265"></a>00265 
<a name="l00271"></a>00271         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a33b5953c7bc054662b4154b8b3b489f9">build_opengl_representation</a>(
<a name="l00272"></a>00272             <span class="keyword">const</span> srba::TKeyFrameID root_keyframe,
<a name="l00273"></a>00273             <span class="keyword">const</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TOpenGLRepresentationOptions.html">TOpenGLRepresentationOptions</a> &amp;options,
<a name="l00274"></a>00274             mrpt::opengl::CSetOfObjectsPtr out_scene,
<a name="l00275"></a>00275             mrpt::opengl::CSetOfObjectsPtr out_root_tree = mrpt::opengl::CSetOfObjectsPtr()
<a name="l00276"></a>00276             ) <span class="keyword">const</span>;
<a name="l00277"></a>00277 
<a name="l00280"></a>00280         <span class="keywordtype">bool</span> <a class="code" href="classsrba_1_1RbaEngine.html#a226a8b58b51ae5fbb5376946af2e892f">save_graph_as_dot</a>(
<a name="l00281"></a>00281             <span class="keyword">const</span> std::string &amp;targetFileName,
<a name="l00282"></a>00282             <span class="keyword">const</span> <span class="keywordtype">bool</span> all_landmarks = <span class="keyword">false</span>
<a name="l00283"></a>00283             ) <span class="keyword">const</span>;
<a name="l00284"></a>00284 
<a name="l00289"></a>00289         <span class="keywordtype">bool</span> <a class="code" href="classsrba_1_1RbaEngine.html#a18deccb1d87805b79d1057ea516e41b3">save_graph_top_structure_as_dot</a>(
<a name="l00290"></a>00290             <span class="keyword">const</span> std::string &amp;targetFileName,
<a name="l00291"></a>00291             <span class="keyword">const</span> <span class="keywordtype">bool</span> set_node_coordinates
<a name="l00292"></a>00292             ) <span class="keyword">const</span>;
<a name="l00293"></a>00293 
<a name="l00301"></a>00301         <span class="keywordtype">double</span> <a class="code" href="classsrba_1_1RbaEngine.html#afd9dfc707a544937695c2ac23def59b6">eval_overall_squared_error</a>() <span class="keyword">const</span>;
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html">00303</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html">ExportGraphSLAM_Params</a>
<a name="l00304"></a>00304         {
<a name="l00305"></a><a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html#a0760a0f6a058c7e4ed05d2c4a414c89b">00305</a>             TKeyFrameID <a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html#a0760a0f6a058c7e4ed05d2c4a414c89b" title="The KF to use as a root for the spanning tree to init global poses (default=0)">root_kf_id</a>; 
<a name="l00306"></a>00306 
<a name="l00307"></a>00307             <a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html">ExportGraphSLAM_Params</a>() : <a class="code" href="structsrba_1_1RbaEngine_1_1ExportGraphSLAM__Params.html#a0760a0f6a058c7e4ed05d2c4a414c89b" title="The KF to use as a root for the spanning tree to init global poses (default=0)">root_kf_id</a>(0) {}
<a name="l00308"></a>00308         };
<a name="l00316"></a>00316         <span class="keyword">template</span> &lt;<span class="keyword">class</span> POSE_GRAPH&gt;
<a name="l00317"></a>00317         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#ac9045312bc064b3548c61610c8807740">get_global_graphslam_problem</a>(POSE_GRAPH &amp;global_graph, <span class="keyword">const</span> ExportGraphSLAM_Params &amp;params = ExportGraphSLAM_Params() ) <span class="keyword">const</span>;
<a name="l00318"></a>00318     
<a name="l00319"></a>00319   <span class="comment">// End of main API methods</span>
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 
<a name="l00327"></a>00327         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a441b2e72c2401a3bb07c89a3c4aeae80">clear</a>();
<a name="l00328"></a>00328 
<a name="l00334"></a>00334         TKeyFrameID <a class="code" href="classsrba_1_1RbaEngine.html#abf4d2e13d959207129be89ad3bd7e67f">alloc_keyframe</a>();
<a name="l00335"></a>00335 
<a name="l00343"></a>00343         <span class="keywordtype">size_t</span> <a class="code" href="classsrba_1_1RbaEngine.html#afeb4a8a93355de22518946526f50b7c8">create_kf2kf_edge</a>(
<a name="l00344"></a>00344             <span class="keyword">const</span> TKeyFrameID        new_kf_id,
<a name="l00345"></a>00345             <span class="keyword">const</span> TPairKeyFrameID  &amp; new_edge,
<a name="l00346"></a>00346             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html#a118ea54cd0d7342acef63c9fdcdad33e">traits_t::new_kf_observations_t</a>   &amp; obs,
<a name="l00347"></a>00347             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> &amp;init_inv_pose_val = <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a>() );
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 
<a name="l00359"></a>00359         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#ae73d37babfc465350b2376daf5f9d352">create_complete_spanning_tree</a>(
<a name="l00360"></a>00360             <span class="keyword">const</span> TKeyFrameID   root_id,
<a name="l00361"></a>00361             frameid2pose_map_t &amp; span_tree,
<a name="l00362"></a>00362             <span class="keyword">const</span> <span class="keywordtype">size_t</span>        max_depth = std::numeric_limits&lt;size_t&gt;::max(),
<a name="l00363"></a>00363             std::vector&lt;bool&gt;  * aux_ws = NULL
<a name="l00364"></a>00364             ) <span class="keyword">const</span>;
<a name="l00365"></a>00365 
<a name="l00375"></a><a class="code" href="classsrba_1_1RbaEngine.html#ab3c19b155e0d3a1aa753df02847e9146">00375</a>         <span class="keywordtype">bool</span> <a class="code" href="classsrba_1_1RbaEngine.html#ab3c19b155e0d3a1aa753df02847e9146">find_path_bfs</a>(
<a name="l00376"></a>00376             <span class="keyword">const</span> TKeyFrameID           src_kf,
<a name="l00377"></a>00377             <span class="keyword">const</span> TKeyFrameID           trg_kf,
<a name="l00378"></a>00378             std::vector&lt;TKeyFrameID&gt;    &amp; found_path)<span class="keyword"> const</span>
<a name="l00379"></a>00379 <span class="keyword">        </span>{
<a name="l00380"></a>00380             <span class="keywordflow">return</span> rba_state.<a class="code" href="structsrba_1_1TRBA__Problem__state.html#a77f091bab0990d2a6a46af44340211a8">find_path_bfs</a>(src_kf,trg_kf,&amp;found_path);
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382 
<a name="l00385"></a><a class="code" href="classsrba_1_1RbaEngine.html#afe9404ae3e15bc8a7ffbd3c27715cd6c">00385</a>         <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> * <a class="code" href="classsrba_1_1RbaEngine.html#afe9404ae3e15bc8a7ffbd3c27715cd6c">get_kf_relative_pose</a>(<span class="keyword">const</span> TKeyFrameID kf_query, <span class="keyword">const</span> TKeyFrameID kf_reference)<span class="keyword"> const</span>
<a name="l00386"></a>00386 <span class="keyword">        </span>{
<a name="l00387"></a>00387             <span class="comment">// Get the relative pose from the numeric spanning tree, which should be up-to-date:</span>
<a name="l00388"></a>00388             <span class="keyword">typename</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1map__as__vector.html#a65f69e85b4976b2dc6652a7695512fef">kf2kf_pose_traits_t::TRelativePosesForEachTarget::const_iterator</a> it_tree4_central = rba_state.spanning_tree.num.find(kf_reference);
<a name="l00389"></a>00389             <span class="keywordflow">if</span> (it_tree4_central==rba_state.spanning_tree.num.end())
<a name="l00390"></a>00390                 <span class="keywordflow">return</span> NULL;
<a name="l00391"></a>00391             <span class="keyword">typename</span> kf2kf_pose_traits_t::frameid2pose_map_t::const_iterator it_nei_1 = 
<a name="l00392"></a>00392                 it_tree4_central-&gt;second.find(kf_query);
<a name="l00393"></a>00393             <span class="keywordflow">if</span> (it_nei_1!=it_tree4_central-&gt;second.end())
<a name="l00394"></a>00394                 <span class="keywordflow">return</span> &amp;it_nei_1-&gt;second.pose;
<a name="l00395"></a>00395             <span class="keywordflow">else</span> <span class="keywordflow">return</span> NULL;
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00402"></a>00402         <span class="keyword">template</span> &lt;
<a name="l00403"></a>00403             <span class="keyword">class </span>KF_VISITOR,
<a name="l00404"></a>00404             <span class="keyword">class </span>FEAT_VISITOR,
<a name="l00405"></a>00405             <span class="keyword">class </span>K2K_EDGE_VISITOR,
<a name="l00406"></a>00406             <span class="keyword">class </span>K2F_EDGE_VISITOR
<a name="l00407"></a>00407             &gt;
<a name="l00408"></a>00408         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a0dd5a776c8786f43640c9530c4dd1f40">bfs_visitor</a>(
<a name="l00409"></a>00409             <span class="keyword">const</span> TKeyFrameID  root_id,
<a name="l00410"></a>00410             <span class="keyword">const</span> topo_dist_t  max_distance,
<a name="l00411"></a>00411             <span class="keyword">const</span> <span class="keywordtype">bool</span> rely_on_prebuilt_spanning_trees,
<a name="l00412"></a>00412             KF_VISITOR       &amp; kf_visitor,
<a name="l00413"></a>00413             FEAT_VISITOR     &amp; feat_visitor,
<a name="l00414"></a>00414             K2K_EDGE_VISITOR &amp; k2k_edge_visitor,
<a name="l00415"></a>00415             K2F_EDGE_VISITOR &amp; k2f_edge_visitor ) <span class="keyword">const</span>;
<a name="l00416"></a>00416   <span class="comment">// End of Extra API methods</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00424"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html">00424</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html">TSRBAParameters</a> : <span class="keyword">public</span> mrpt::utils::CLoadableOptions
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426             <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html">TSRBAParameters</a>();
<a name="l00427"></a>00427 
<a name="l00429"></a>00429             <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a94e4a7551e5591ff74b1bc62ba90a4b4">loadFromConfigFile</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_c_config_file_base.html">mrpt::utils::CConfigFileBase</a> &amp; source,<span class="keyword">const</span> std::string &amp; section);
<a name="l00431"></a>00431             <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a15732bafbb3147c5d0026612a98fb842">saveToConfigFile</a>(<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_c_config_file_base.html">mrpt::utils::CConfigFileBase</a> &amp;out,<span class="keyword">const</span> std::string &amp; section) <span class="keyword">const</span>;
<a name="l00432"></a>00432 
<a name="l00434"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a13a8b7a0c8bb02e87c050e29749c19cd">00434</a>             topo_dist_t          <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a13a8b7a0c8bb02e87c050e29749c19cd">max_tree_depth</a>;
<a name="l00435"></a>00435 
<a name="l00437"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a229c98d0816e98edac7a696c224d24e0">00437</a>             topo_dist_t          <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a229c98d0816e98edac7a696c224d24e0">max_optimize_depth</a>;
<a name="l00438"></a>00438             <span class="comment">// -------------------------------------------------------</span>
<a name="l00439"></a>00439 
<a name="l00440"></a>00440             <span class="comment">// Parameters for optimize_*()</span>
<a name="l00441"></a>00441             <span class="comment">// -------------------------------------</span>
<a name="l00442"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a5a7c2892868ebfff8fa07e62887d1c23">00442</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a5a7c2892868ebfff8fa07e62887d1c23" title="(Default:true) Before running a whole &quot;local area&quot; optimization, try to optimize new edges one by one...">optimize_new_edges_alone</a>; 
<a name="l00443"></a>00443             <span class="keywordtype">bool</span>   use_robust_kernel;
<a name="l00444"></a>00444             <span class="keywordtype">bool</span>   use_robust_kernel_stage1;
<a name="l00445"></a>00445             <span class="keywordtype">double</span> kernel_param;
<a name="l00446"></a>00446             <span class="keywordtype">size_t</span> max_iters;
<a name="l00447"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a88d7ab125c4bfa10342f0be672cd8d7b">00447</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a88d7ab125c4bfa10342f0be672cd8d7b" title="default: 1e-9">max_error_per_obs_to_stop</a>; 
<a name="l00448"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#aa267ab19e17d5e5e4d62e4e4e140d8b5">00448</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#aa267ab19e17d5e5e4d62e4e4e140d8b5" title="default: 1.0">max_rho</a>; 
<a name="l00449"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#ae0a779cfb7a932f59b166986fd673972">00449</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#ae0a779cfb7a932f59b166986fd673972" title="default: 1e20">max_lambda</a>; 
<a name="l00450"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#afa02977477b2669872901c0c5fe36f63">00450</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#afa02977477b2669872901c0c5fe36f63" title="default 0.01">min_error_reduction_ratio_to_relinearize</a>; 
<a name="l00451"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a587619c3b97cb62dd764e638cb01be71">00451</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a587619c3b97cb62dd764e638cb01be71" title="(Default:false) Use a numeric approximation of the Jacobians (very slow!) instead of analytical ones...">numeric_jacobians</a>; 
<a name="l00452"></a>00452             void (*feedback_user_iteration)(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter, <span class="keyword">const</span> <span class="keywordtype">double</span> total_sq_err, <span class="keyword">const</span> <span class="keywordtype">double</span> mean_sqroot_error);
<a name="l00453"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#aab1e59f481e41b64d171c9486051d3d9">00453</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#aab1e59f481e41b64d171c9486051d3d9" title="Compute and return to the user the Hessian condition number of k2k edges (default=false)">compute_condition_number</a>; 
<a name="l00454"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#ac1caa8f191d36fecfd0eaf8ece03b05b">00454</a>             <span class="keywordtype">bool</span>   <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#ac1caa8f191d36fecfd0eaf8ece03b05b" title="Compute stats on the sparsity of the problem matrices (default=false)">compute_sparsity_stats</a>;   
<a name="l00455"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a37c065297f4f1d79aee53c338628e569">00455</a>             <span class="keywordtype">double</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a37c065297f4f1d79aee53c338628e569" title="Minimum RSME to show optimization error in red color (default=0.5)">max_rmse_show_red_warning</a>; 
<a name="l00456"></a>00456 
<a name="l00457"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a69d444e35e521de69ddba2d9052d1c9b">00457</a>             TCovarianceRecoveryPolicy  <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html#a69d444e35e521de69ddba2d9052d1c9b" title="Recover covariance? What method to use? (Default: crpLandmarksApprox)">cov_recovery</a>; 
<a name="l00458"></a>00458             <span class="comment">// -------------------------------------</span>
<a name="l00459"></a>00459 
<a name="l00460"></a>00460         };
<a name="l00461"></a>00461 
<a name="l00463"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html">00463</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html">TAllParameters</a>
<a name="l00464"></a>00464         {
<a name="l00465"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#ae342f404a7ae8720646845efb1c8fd69">00465</a>             <a class="code" href="structsrba_1_1RbaEngine_1_1TSRBAParameters.html">TSRBAParameters</a>                                                <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#ae342f404a7ae8720646845efb1c8fd69" title="Different parameters for the SRBA methods.">srba</a>;        
<a name="l00466"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#a4060156897a7ec7fccc5e891d3d67e50">00466</a>             <span class="keyword">typename</span> obs_t::TObservationParams                             <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#a4060156897a7ec7fccc5e891d3d67e50" title="Sensor-specific parameters (sensor calibration, etc.)">sensor</a>;      
<a name="l00467"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#ad0c1a8642d1156b37d3a843259a0d530">00467</a>             <span class="keyword">typename</span> RBA_OPTIONS::sensor_pose_on_robot_t::parameters_t  <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#ad0c1a8642d1156b37d3a843259a0d530" title="Parameters related to the relative pose of sensors wrt the robot (if applicable)">sensor_pose</a>; 
<a name="l00468"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#af163f57ec24df2d3127639d1de39fab7">00468</a>             <span class="keyword">typename</span> RBA_OPTIONS::obs_noise_matrix_t::parameters_t      <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#af163f57ec24df2d3127639d1de39fab7" title="Parameters related to the sensor noise covariance matrix.">obs_noise</a>;   
<a name="l00469"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#a48db6942ab637179b2ca238ac19fb463">00469</a>             <span class="keyword">typename</span> <a class="code" href="structsrba_1_1ecps_1_1local__areas__fixed__size_1_1parameters__t.html">RBA_OPTIONS::edge_creation_policy_t::parameters_t</a>  <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html#a48db6942ab637179b2ca238ac19fb463" title="Parameters for the edge creation policy.">ecp</a>;         
<a name="l00470"></a>00470 
<a name="l00471"></a>00471             <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/memory_8h.html#ae8980bd7f8c37e72ce7763c5d94f0076">MRPT_MAKE_ALIGNED_OPERATOR_NEW</a>  <span class="comment">// Required by Eigen containers</span>
<a name="l00472"></a>00472         };
<a name="l00473"></a><a class="code" href="classsrba_1_1RbaEngine.html#a3d2f22996f0d3d38cc467fc283d42eb0">00473</a>         <a class="code" href="structsrba_1_1RbaEngine_1_1TAllParameters.html">TAllParameters</a> <a class="code" href="classsrba_1_1RbaEngine.html#a3d2f22996f0d3d38cc467fc283d42eb0" title="Hierarchical struct with all parameters.">parameters</a>; 
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="classsrba_1_1RbaEngine.html#a202a8517305e82a724ffa8e2f4035881">00475</a>         <span class="keyword">typename</span> <a class="code" href="structsrba_1_1ecps_1_1local__areas__fixed__size.html">RBA_OPTIONS::edge_creation_policy_t</a>   <a class="code" href="classsrba_1_1RbaEngine.html#a202a8517305e82a724ffa8e2f4035881" title="The edge creation policy object.">edge_creation_policy</a>; 
<a name="l00476"></a>00476   <span class="comment">// End of data fields</span>
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 
<a name="l00481"></a><a class="code" href="classsrba_1_1RbaEngine.html#a59cf6a8a559c8d070f024ea946388a8a">00481</a>         <span class="keywordtype">void</span> <span class="keyword">inline</span> <a class="code" href="classsrba_1_1RbaEngine.html#a59cf6a8a559c8d070f024ea946388a8a">enable_time_profiler</a>(<span class="keywordtype">bool</span> enable=<span class="keyword">true</span>) { m_profiler.<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_c_time_logger.html#a8d8bb7ec6e550806ef110ef6e5bc3bae">enable</a>(enable); }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b" title="A list (deque) of KF-to-KF edges (unknown relative poses).">k2k_edges_deque_t</a> &amp; get_k2k_edges()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> rba_state.<a class="code" href="structsrba_1_1TRBA__Problem__state.html#a3aa20d077c1584dfbd431a0aca126e9e" title="(unknowns) All keyframe-to-keyframe edges">k2k_edges</a>; }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7a58dde8b100c4cbd3181ffa30845971" title="An index of feature IDs and their relative locations.">TRelativeLandmarkPosMap</a> &amp; get_known_feats()<span class="keyword">   const </span>{ <span class="keywordflow">return</span> rba_state.<a class="code" href="structsrba_1_1TRBA__Problem__state.html#a8db62e44aa6bf35b906690ff59b213a9" title="(known values) Landmarks with a known, fixed 3D position relative to their base frame_id">known_lms</a>; }
<a name="l00486"></a>00486         <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7a58dde8b100c4cbd3181ffa30845971" title="An index of feature IDs and their relative locations.">TRelativeLandmarkPosMap</a> &amp; get_unknown_feats()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> rba_state.<a class="code" href="structsrba_1_1TRBA__Problem__state.html#a572762242eedf9f0d8146c353ab619f9" title="(unknown values) Landmarks with an unknown fixed 3D position relative to their base frame_id...">unknown_lms</a>; }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="keyword">const</span> rba_problem_state_t &amp; get_rba_state()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> rba_state; }
<a name="l00489"></a>00489         rba_problem_state_t       &amp; get_rba_state()       { <span class="keywordflow">return</span> rba_state; }
<a name="l00490"></a>00490 
<a name="l00492"></a><a class="code" href="classsrba_1_1RbaEngine.html#ad60527df4e70255f2776983f116bf189">00492</a>         <span class="keyword">inline</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_c_time_logger.html">mrpt::utils::CTimeLogger</a> &amp; <a class="code" href="classsrba_1_1RbaEngine.html#ad60527df4e70255f2776983f116bf189">get_time_profiler</a>() { <span class="keywordflow">return</span> m_profiler; }
<a name="l00493"></a>00493 
<a name="l00495"></a><a class="code" href="classsrba_1_1RbaEngine.html#a9d1ef5167ff512b5d151e129fd731cd5">00495</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a9d1ef5167ff512b5d151e129fd731cd5">setVerbosityLevel</a>(<span class="keywordtype">int</span> level) { <a class="code" href="classsrba_1_1RbaEngine.html#a9972990f05334df49046ec43a177bf46" title="0: None (only critical msgs), 1: verbose (default value), 2:even more verbose, 3: even more...">m_verbose_level</a> = level; }
<a name="l00496"></a>00496 
<a name="l00500"></a>00500         <span class="keyword">template</span> &lt;<span class="keyword">class</span> HESS_Ap, <span class="keyword">class</span> HESS_f,<span class="keyword">class</span> HESS_Apf, <span class="keyword">class</span> JACOB_COLUMN_dh_dAp,<span class="keyword">class</span> JACOB_COLUMN_dh_df&gt;
<a name="l00501"></a>00501         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a6721d5ed73e422aab8fa4b01b71f8f47">sparse_hessian_build_symbolic</a>(
<a name="l00502"></a>00502             HESS_Ap &amp; HAp,
<a name="l00503"></a>00503             HESS_f &amp; Hf,
<a name="l00504"></a>00504             HESS_Apf &amp; HApf,
<a name="l00505"></a>00505             <span class="keyword">const</span> std::vector&lt;JACOB_COLUMN_dh_dAp*&gt; &amp; dh_dAp,
<a name="l00506"></a>00506             <span class="keyword">const</span> std::vector&lt;JACOB_COLUMN_dh_df*&gt;  &amp; dh_df);
<a name="l00507"></a>00507 
<a name="l00513"></a>00513         <span class="keyword">template</span> &lt;<span class="keyword">class</span> SPARSEBLOCKHESSIAN&gt;
<a name="l00514"></a>00514         <span class="keywordtype">size_t</span> <a class="code" href="classsrba_1_1RbaEngine.html#ad9028b772a3ad3cd5f4c492a4bbfb84c">sparse_hessian_update_numeric</a>( SPARSEBLOCKHESSIAN &amp; H ) <span class="keyword">const</span>;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="keyword">protected</span>:
<a name="l00518"></a><a class="code" href="classsrba_1_1RbaEngine.html#a9972990f05334df49046ec43a177bf46">00518</a>         <span class="keywordtype">int</span> <a class="code" href="classsrba_1_1RbaEngine.html#a9972990f05334df49046ec43a177bf46" title="0: None (only critical msgs), 1: verbose (default value), 2:even more verbose, 3: even more...">m_verbose_level</a>; 
<a name="l00519"></a>00519 
<a name="l00524"></a>00524         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a22c6828025a062037fa227b68ea38bde">determine_kf2kf_edges_to_create</a>(
<a name="l00525"></a>00525             <span class="keyword">const</span> TKeyFrameID               new_kf_id,
<a name="l00526"></a>00526             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t.html#a118ea54cd0d7342acef63c9fdcdad33e">traits_t::new_kf_observations_t</a>   &amp; obs,
<a name="l00527"></a>00527             std::vector&lt;TNewEdgeInfo&gt; &amp;new_k2k_edge_ids );
<a name="l00528"></a>00528 
<a name="l00533"></a>00533         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7c9012717d290754a160e235c7b271b4">optimize_edges</a>(
<a name="l00534"></a>00534             <span class="keyword">const</span> std::vector&lt;size_t&gt; &amp; run_k2k_edges,
<a name="l00535"></a>00535             <span class="keyword">const</span> std::vector&lt;size_t&gt; &amp; run_feat_ids_in,
<a name="l00536"></a>00536             <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeExtraOutputInfo.html">TOptimizeExtraOutputInfo</a> &amp; out_info,
<a name="l00537"></a>00537             <span class="keyword">const</span> std::vector&lt;size_t&gt; &amp; observation_indices_to_optimize = std::vector&lt;size_t&gt;()
<a name="l00538"></a>00538             );
<a name="l00539"></a>00539 
<a name="l00543"></a><a class="code" href="structsrba_1_1RbaEngine_1_1VisitorOptimizeLocalArea.html">00543</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1VisitorOptimizeLocalArea.html">VisitorOptimizeLocalArea</a>
<a name="l00544"></a>00544         {
<a name="l00545"></a>00545             <a class="code" href="structsrba_1_1RbaEngine_1_1VisitorOptimizeLocalArea.html">VisitorOptimizeLocalArea</a>(<span class="keyword">const</span> <a class="code" href="structsrba_1_1TRBA__Problem__state.html">rba_problem_state_t</a> &amp; rba_state_, <span class="keyword">const</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html">TOptimizeLocalAreaParams</a> &amp;params_) :
<a name="l00546"></a>00546                 rba_state(rba_state_),
<a name="l00547"></a>00547                 params(params_)
<a name="l00548"></a>00548             { }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550             <span class="keyword">const</span> <a class="code" href="structsrba_1_1TRBA__Problem__state.html">rba_problem_state_t</a> &amp; rba_state;
<a name="l00551"></a>00551             <span class="keyword">const</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html">TOptimizeLocalAreaParams</a> &amp;params;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553             std::vector&lt;size_t&gt; k2k_edges_to_optimize, lm_IDs_to_optimize;
<a name="l00554"></a>00554             std::map&lt;TLandmarkID,size_t&gt;  lm_times_seen;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556             <span class="comment">/* Implementation of FEAT_VISITOR */</span>
<a name="l00557"></a>00557             <span class="keyword">inline</span> <span class="keywordtype">bool</span> visit_filter_feat(<span class="keyword">const</span> TLandmarkID lm_ID,<span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00558"></a>00558             {
<a name="l00559"></a>00559                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(lm_ID); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00560"></a>00560                 <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Don&#39;t need to visit landmark nodes.</span>
<a name="l00561"></a>00561             }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563             <span class="keyword">inline</span> <span class="keywordtype">void</span> visit_feat(<span class="keyword">const</span> TLandmarkID lm_ID,<span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00564"></a>00564             {
<a name="l00565"></a>00565                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(lm_ID); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00566"></a>00566                 <span class="comment">// Nothing to do</span>
<a name="l00567"></a>00567             }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569             <span class="comment">/* Implementation of KF_VISITOR */</span>
<a name="l00570"></a>00570             <span class="keyword">inline</span> <span class="keywordtype">bool</span> visit_filter_kf(<span class="keyword">const</span> TKeyFrameID kf_ID,<span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00571"></a>00571             {
<a name="l00572"></a>00572                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00573"></a>00573                 <span class="keywordflow">return</span> (kf_ID&lt;=params.<a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a72b81ccf815e3f3788d342f56e70e9e6" title="While exploring around the root KF, stop the BFS when KF_ID&gt;=this number (default:infinity)">max_visitable_kf_id</a>);
<a name="l00574"></a>00574             }
<a name="l00575"></a>00575 
<a name="l00576"></a>00576             <span class="keyword">inline</span> <span class="keywordtype">void</span> visit_kf(<span class="keyword">const</span> TKeyFrameID kf_ID,<span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00577"></a>00577             {
<a name="l00578"></a>00578                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(kf_ID); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00579"></a>00579                 <span class="comment">// Nothing to do.</span>
<a name="l00580"></a>00580             }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582             <span class="comment">/* Implementation of K2K_EDGE_VISITOR */</span>
<a name="l00583"></a>00583             <span class="keyword">inline</span> <span class="keywordtype">bool</span> visit_filter_k2k(<span class="keyword">const</span> TKeyFrameID current_kf, <span class="keyword">const</span> TKeyFrameID next_kf,
<a name="l00584"></a>00584                 <span class="keyword">const</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html">k2k_edge_t</a>* edge, <span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00585"></a>00585             {
<a name="l00586"></a>00586                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(current_kf); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(next_kf);
<a name="l00587"></a>00587                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(edge); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00588"></a>00588                 <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Visit all k2k edges</span>
<a name="l00589"></a>00589             }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591             <span class="keyword">inline</span> <span class="keywordtype">void</span> visit_k2k(<span class="keyword">const</span> TKeyFrameID current_kf, <span class="keyword">const</span> TKeyFrameID next_kf,
<a name="l00592"></a>00592                 <span class="keyword">const</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html">k2k_edge_t</a>* edge, <span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00593"></a>00593             {
<a name="l00594"></a>00594                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(current_kf); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(next_kf);
<a name="l00595"></a>00595                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00596"></a>00596                 <span class="keywordflow">if</span> (params.optimize_k2k_edges)
<a name="l00597"></a>00597                     k2k_edges_to_optimize.push_back(edge-&gt;<a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html#ad8cb7311ea025a529b590ab75996ce0a" title="0-based index of this edge, in the std::list &quot;k2k_edges&quot;.">id</a>);
<a name="l00598"></a>00598             }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600             <span class="comment">/* Implementation of K2F_EDGE_VISITOR */</span>
<a name="l00601"></a>00601             <span class="keyword">inline</span> <span class="keywordtype">bool</span> visit_filter_k2f(<span class="keyword">const</span> TKeyFrameID current_kf, <span class="keyword">const</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a>* edge,
<a name="l00602"></a>00602                 <span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00603"></a>00603             {
<a name="l00604"></a>00604                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(current_kf); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(edge); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00605"></a>00605                 <span class="keywordflow">return</span> params.optimize_landmarks; <span class="comment">// Yes: visit all feature nodes if we&#39;re asked to</span>
<a name="l00606"></a>00606             }
<a name="l00607"></a>00607             <span class="keyword">inline</span> <span class="keywordtype">void</span> visit_k2f(<span class="keyword">const</span> TKeyFrameID current_kf, <span class="keyword">const</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a>* edge, <span class="keyword">const</span> topo_dist_t cur_dist)
<a name="l00608"></a>00608             {
<a name="l00609"></a>00609                 <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(current_kf); <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/mrpt__macros_8h.html#acc2e7c5641dd177b8a1c6f2d2470c8b7">MRPT_UNUSED_PARAM</a>(cur_dist);
<a name="l00610"></a>00610                 <span class="keywordflow">if</span> (!edge-&gt;<a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html#aaff71d3bf43660a0268a490a366f71ef" title="whether it&#39;s a known or unknown relative position feature">feat_has_known_rel_pos</a>)
<a name="l00611"></a>00611                 {
<a name="l00612"></a>00612                     <span class="keyword">const</span> TLandmarkID lm_ID = edge-&gt;obs.<a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1kf__observation__t.html#a60851257002b7fe613262786c7213de1" title="Observation data.">obs</a>.<a class="code" href="structsrba_1_1observation__traits_1_1observation__t.html#a22ef7e48eb566ab81765ae1cea9f8c0e" title="Observed what.">feat_id</a>;
<a name="l00613"></a>00613                     <span class="comment">// Use an &quot;==&quot; so we only add the LM_ID to the list ONCE, just when it passes the threshold</span>
<a name="l00614"></a>00614                     <span class="keywordflow">if</span> (++lm_times_seen[lm_ID] == params.<a class="code" href="structsrba_1_1RbaEngine_1_1TOptimizeLocalAreaParams.html#a6a5549969928d7be769431494b3104d5" title="Set to 1 to try to optimize all landmarks even if they&#39;re just observed once, which may makes sense d...">dont_optimize_landmarks_seen_less_than_n_times</a>)
<a name="l00615"></a>00615                         lm_IDs_to_optimize.push_back(lm_ID);
<a name="l00616"></a>00616                 }
<a name="l00617"></a>00617             }
<a name="l00618"></a>00618         };
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     <span class="keyword">private</span>:
<a name="l00621"></a>00621         <a class="code" href="structsrba_1_1TRBA__Problem__state.html">rba_problem_state_t</a>  rba_state;  
<a name="l00622"></a>00622 
<a name="l00623"></a>00623         <span class="keyword">mutable</span> std::vector&lt;bool&gt; m_complete_st_ws; 
<a name="l00624"></a>00624 
<a name="l00628"></a>00628         <span class="keyword">mutable</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1utils_1_1_c_time_logger.html">mrpt::utils::CTimeLogger</a>  m_profiler;
<a name="l00629"></a>00629 
<a name="l00645"></a>00645         <span class="keywordtype">size_t</span> add_observation(
<a name="l00646"></a>00646             <span class="keyword">const</span> TKeyFrameID         observing_kf_id,
<a name="l00647"></a>00647             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1observation__traits_1_1observation__t.html">observation_traits_t::observation_t</a>     &amp; new_obs,
<a name="l00648"></a>00648             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> * fixed_relative_position = NULL,
<a name="l00649"></a>00649             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> * unknown_relative_position_init_val = NULL
<a name="l00650"></a>00650             );
<a name="l00651"></a>00651 
<a name="l00653"></a>00653         <span class="keywordtype">void</span> prepare_Jacobians_required_tree_roots(
<a name="l00654"></a>00654             std::set&lt;TKeyFrameID&gt;  &amp; kfs_num_spantrees_to_update,
<a name="l00655"></a>00655             <span class="keyword">const</span> std::vector&lt;typename TSparseBlocksJacobians_dh_dAp::col_t*&gt; &amp;lst_JacobCols_dAp,
<a name="l00656"></a>00656             <span class="keyword">const</span> std::vector&lt;typename TSparseBlocksJacobians_dh_df::col_t*&gt;  &amp;lst_JacobCols_df );
<a name="l00657"></a>00657 
<a name="l00658"></a>00658 
<a name="l00660"></a>00660         <span class="keywordtype">size_t</span> recompute_all_Jacobians(
<a name="l00661"></a>00661             std::vector&lt;typename TSparseBlocksJacobians_dh_dAp::col_t*&gt; &amp;lst_JacobCols_dAp,
<a name="l00662"></a>00662             std::vector&lt;typename TSparseBlocksJacobians_dh_df::col_t*&gt;  &amp;lst_JacobCols_df,
<a name="l00663"></a>00663             std::vector&lt;const pose_flag_t*&gt;    * out_list_of_required_num_poses = NULL );
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     <span class="keyword">public</span>:
<a name="l00666"></a>00666 
<a name="l00668"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TBFSEntryEdges.html">00668</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TBFSEntryEdges.html">TBFSEntryEdges</a>
<a name="l00669"></a>00669         {
<a name="l00670"></a>00670             <a class="code" href="structsrba_1_1RbaEngine_1_1TBFSEntryEdges.html">TBFSEntryEdges</a>() : dist( std::numeric_limits&lt;topo_dist_t&gt;::max() ), edge(NULL)
<a name="l00671"></a>00671             {}
<a name="l00672"></a>00672 
<a name="l00673"></a>00673             TKeyFrameID prev;
<a name="l00674"></a>00674             topo_dist_t dist;
<a name="l00675"></a>00675             <span class="keyword">const</span> <a class="code" href="structsrba_1_1kf2kf__pose__traits_1_1k2k__edge__t.html">k2k_edge_t</a>* edge;
<a name="l00676"></a>00676         };
<a name="l00677"></a>00677 
<a name="l00678"></a>00678 
<a name="l00691"></a>00691         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#ae48c4fcb3c4374cefd5804d56fa08f5e">compute_jacobian_dh_dp</a>(
<a name="l00692"></a>00692             <span class="keyword">typename</span> TSparseBlocksJacobians_dh_dAp::TEntry  &amp;jacob,
<a name="l00693"></a>00693             <span class="keyword">const</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a> &amp; observation,
<a name="l00694"></a>00694             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b" title="A list (deque) of KF-to-KF edges (unknown relative poses).">k2k_edges_deque_t</a>  &amp;k2k_edges,
<a name="l00695"></a>00695             std::vector&lt;const pose_flag_t*&gt;    *out_list_of_required_num_poses) <span class="keyword">const</span>;
<a name="l00696"></a>00696 
<a name="l00707"></a>00707         <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#a652e7f62609ac889500a2622d3ea90bf">compute_jacobian_dh_df</a>(
<a name="l00708"></a>00708             <span class="keyword">typename</span> TSparseBlocksJacobians_dh_df::TEntry  &amp;jacob,
<a name="l00709"></a>00709             <span class="keyword">const</span> <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a> &amp; observation,
<a name="l00710"></a>00710             std::vector&lt;const pose_flag_t*&gt; *out_list_of_required_num_poses) <span class="keyword">const</span>;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <span class="keywordtype">void</span> gl_aux_draw_node(<a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1opengl_1_1_c_set_of_objects.html">mrpt::opengl::CSetOfObjects</a> &amp;soo, <span class="keyword">const</span> std::string &amp;label, <span class="keyword">const</span> <span class="keywordtype">float</span> x, <span class="keyword">const</span> <span class="keywordtype">float</span> y) <span class="keyword">const</span>;
<a name="l00713"></a>00713 
<a name="l00714"></a><a class="code" href="classsrba_1_1RbaEngine.html#a119b179262d8ef5f60ad7921a1dbcc31">00714</a>         <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> <a class="code" href="classsrba_1_1RbaEngine.html#a119b179262d8ef5f60ad7921a1dbcc31" title="A fixed SE(3) pose at the origin (used when we need a pointer or a reference to a &quot;null transformatio...">aux_null_pose</a>; 
<a name="l00715"></a>00715 
<a name="l00716"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__dAp__params.html">00716</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__dAp__params.html">TNumeric_dh_dAp_params</a>
<a name="l00717"></a>00717         {
<a name="l00718"></a>00718             <a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__dAp__params.html">TNumeric_dh_dAp_params</a>(
<a name="l00719"></a>00719                 <span class="keyword">const</span> <span class="keywordtype">size_t</span>  _k2k_edge_id,
<a name="l00720"></a>00720                 <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> * _pose_d1_wrt_obs,
<a name="l00721"></a>00721                 <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> &amp; _pose_base_wrt_d1,
<a name="l00722"></a>00722                 <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> &amp; _xji_i,
<a name="l00723"></a>00723                 <span class="keyword">const</span> <span class="keywordtype">bool</span> _is_inverse_dir,
<a name="l00724"></a>00724                 <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b" title="A list (deque) of KF-to-KF edges (unknown relative poses).">k2k_edges_deque_t</a>  &amp;_k2k_edges,
<a name="l00725"></a>00725                 <span class="keyword">const</span> <span class="keyword">typename</span> obs_t::TObservationParams   &amp; _sensor_params,
<a name="l00726"></a>00726                 <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1options_1_1sensor__pose__on__robot__none_1_1parameters__t.html">RBA_OPTIONS::sensor_pose_on_robot_t::parameters_t</a>  &amp; _sensor_pose
<a name="l00727"></a>00727                 ) :
<a name="l00728"></a>00728             k2k_edge_id(_k2k_edge_id),
<a name="l00729"></a>00729             pose_d1_wrt_obs(_pose_d1_wrt_obs),
<a name="l00730"></a>00730             pose_base_wrt_d1(_pose_base_wrt_d1),
<a name="l00731"></a>00731             xji_i(_xji_i),
<a name="l00732"></a>00732             is_inverse_dir(_is_inverse_dir),
<a name="l00733"></a>00733             k2k_edges(_k2k_edges),
<a name="l00734"></a>00734             sensor_params(_sensor_params),
<a name="l00735"></a>00735             sensor_pose(_sensor_pose)
<a name="l00736"></a>00736             {
<a name="l00737"></a>00737             }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739             <span class="keyword">const</span> <span class="keywordtype">size_t</span> k2k_edge_id;
<a name="l00740"></a>00740             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> * pose_d1_wrt_obs;
<a name="l00741"></a>00741             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> &amp; pose_base_wrt_d1;
<a name="l00742"></a>00742             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> &amp; xji_i;
<a name="l00743"></a>00743             <span class="keyword">const</span> <span class="keywordtype">bool</span> is_inverse_dir;
<a name="l00744"></a>00744             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#aa331a47a6a8b6c5435843714fbcdbe7b" title="A list (deque) of KF-to-KF edges (unknown relative poses).">k2k_edges_deque_t</a>  &amp;k2k_edges;
<a name="l00745"></a>00745             <span class="keyword">const</span> <span class="keyword">typename</span> obs_t::TObservationParams   &amp; sensor_params;
<a name="l00746"></a>00746             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1options_1_1sensor__pose__on__robot__none_1_1parameters__t.html">RBA_OPTIONS::sensor_pose_on_robot_t::parameters_t</a>  &amp; sensor_pose;
<a name="l00747"></a>00747         };
<a name="l00748"></a>00748 
<a name="l00749"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__df__params.html">00749</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__df__params.html">TNumeric_dh_df_params</a>
<a name="l00750"></a>00750         {
<a name="l00751"></a>00751             <a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__df__params.html">TNumeric_dh_df_params</a>(
<a name="l00752"></a>00752                 <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> * _pose_base_wrt_obs,
<a name="l00753"></a>00753                 <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> &amp; _xji_i,
<a name="l00754"></a>00754                 <span class="keyword">const</span> <span class="keyword">typename</span> obs_t::TObservationParams   &amp; _sensor_params,
<a name="l00755"></a>00755                 <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1options_1_1sensor__pose__on__robot__none_1_1parameters__t.html">RBA_OPTIONS::sensor_pose_on_robot_t::parameters_t</a>  &amp; _sensor_pose
<a name="l00756"></a>00756                 ) :
<a name="l00757"></a>00757             pose_base_wrt_obs(_pose_base_wrt_obs),
<a name="l00758"></a>00758             xji_i(_xji_i),
<a name="l00759"></a>00759             sensor_params(_sensor_params),
<a name="l00760"></a>00760             sensor_pose(_sensor_pose)
<a name="l00761"></a>00761             {
<a name="l00762"></a>00762             }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764             <span class="keyword">const</span> <a class="code" href="classsrba_1_1RbaEngine.html#a7e93fb52935f6a322a74e83ae228cf6c" title="The type of relative poses (e.g. mrpt::poses::CPose3D)">pose_t</a> * pose_base_wrt_obs;
<a name="l00765"></a>00765             <span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> &amp; xji_i;
<a name="l00766"></a>00766             <span class="keyword">const</span> <span class="keyword">typename</span> obs_t::TObservationParams   &amp; sensor_params;
<a name="l00767"></a>00767             <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structsrba_1_1options_1_1sensor__pose__on__robot__none_1_1parameters__t.html">RBA_OPTIONS::sensor_pose_on_robot_t::parameters_t</a>  &amp; sensor_pose;
<a name="l00768"></a>00768         };
<a name="l00769"></a>00769 
<a name="l00771"></a>00771         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#afe98fcb904d0feffd713741eea8aeccb">numeric_dh_dAp</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_pose_t</a> &amp;x, <span class="keyword">const</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__dAp__params.html">TNumeric_dh_dAp_params</a>&amp; params, <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_obs_t</a> &amp;y);
<a name="l00773"></a>00773         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classsrba_1_1RbaEngine.html#aa4bbfeb622c6bbaafcc36627d4035142">numeric_dh_df</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_landmark_t</a> &amp;x, <span class="keyword">const</span> <a class="code" href="structsrba_1_1RbaEngine_1_1TNumeric__dh__df__params.html">TNumeric_dh_df_params</a>&amp; params, <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/classmrpt_1_1math_1_1_c_array_double.html">array_obs_t</a> &amp;y);
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> add_edge_ij_to_list_needed_roots(std::set&lt;TKeyFrameID&gt;  &amp; lst, <span class="keyword">const</span> TKeyFrameID i, <span class="keyword">const</span> TKeyFrameID j)
<a name="l00776"></a>00776         {
<a name="l00777"></a>00777             lst.insert(i);
<a name="l00778"></a>00778             lst.insert(j);
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781         <span class="keywordtype">void</span> compute_minus_gradient(
<a name="l00782"></a>00782             Eigen::VectorXd &amp; minus_grad,
<a name="l00783"></a>00783             <span class="keyword">const</span> std::vector&lt;typename TSparseBlocksJacobians_dh_dAp::col_t*&gt; &amp; sparse_jacobs_Ap,
<a name="l00784"></a>00784             <span class="keyword">const</span> std::vector&lt;typename TSparseBlocksJacobians_dh_df::col_t*&gt; &amp; sparse_jacobs_f,
<a name="l00785"></a>00785             <span class="keyword">const</span> vector_residuals_t  &amp; residuals,
<a name="l00786"></a>00786             <span class="keyword">const</span> std::map&lt;size_t,size_t&gt; &amp;obs_global_idx2residual_idx
<a name="l00787"></a>00787             ) <span class="keyword">const</span>;
<a name="l00788"></a>00788 
<a name="l00790"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html">00790</a>         <span class="keyword">struct </span><a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html">TObsUsed</a>
<a name="l00791"></a>00791         {
<a name="l00792"></a>00792             <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html">TObsUsed</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> obs_idx_, <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a> * <span class="keyword">const</span> k2f_) : <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#acb3210c2b7f22e1956b9d94b96e80360" title="Global index in all_observations.">obs_idx</a>(obs_idx_),<a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#ad68ea04125c4f7d72bf9051cd2946fa1" title="Obs data.">k2f</a>(k2f_)
<a name="l00793"></a>00793             { }
<a name="l00794"></a>00794 
<a name="l00795"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#acb3210c2b7f22e1956b9d94b96e80360">00795</a>             <span class="keywordtype">size_t</span>      <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#acb3210c2b7f22e1956b9d94b96e80360" title="Global index in all_observations.">obs_idx</a>; 
<a name="l00796"></a><a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#ad68ea04125c4f7d72bf9051cd2946fa1">00796</a>             <a class="code" href="structsrba_1_1rba__joint__parameterization__traits__t_1_1k2f__edge__t.html">k2f_edge_t</a>*  <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#ad68ea04125c4f7d72bf9051cd2946fa1" title="Obs data.">k2f</a>;     
<a name="l00797"></a>00797 
<a name="l00798"></a>00798         <span class="keyword">private</span>:
<a name="l00799"></a>00799             <span class="comment">// Don&#39;t use this constructor</span>
<a name="l00800"></a>00800             <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html">TObsUsed</a>() : <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#acb3210c2b7f22e1956b9d94b96e80360" title="Global index in all_observations.">obs_idx</a>(0), <a class="code" href="structsrba_1_1RbaEngine_1_1TObsUsed.html#ad68ea04125c4f7d72bf9051cd2946fa1" title="Obs data.">k2f</a>(NULL) {}
<a name="l00801"></a>00801         }; <span class="comment">// end of TObsUsed</span>
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 
<a name="l00804"></a>00804         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classsrba_1_1RbaEngine.html#a0c22bc4d6045612024e651aff7815fd0">reprojection_residuals</a>(
<a name="l00805"></a>00805             vector_residuals_t &amp; residuals, <span class="comment">// Out:</span>
<a name="l00806"></a>00806             <span class="keyword">const</span> std::vector&lt;TObsUsed&gt; &amp; observations <span class="comment">// In:</span>
<a name="l00807"></a>00807             ) <span class="keyword">const</span>;
<a name="l00808"></a>00808 
<a name="l00810"></a><a class="code" href="classsrba_1_1RbaEngine.html#a698a002f75218f66526c65eb8d1405f6">00810</a>         <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classsrba_1_1RbaEngine.html#a698a002f75218f66526c65eb8d1405f6">huber_kernel</a>(<span class="keywordtype">double</span> delta, <span class="keyword">const</span> <span class="keywordtype">double</span> kernel_param)
<a name="l00811"></a>00811         {
<a name="l00812"></a>00812             <span class="keywordflow">return</span> std::abs(2*mrpt::utils::square(kernel_param)*(std::sqrt(1+mrpt::utils::square(delta/kernel_param))-1));
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815         <a class="codeRef" doxygen="dox_mrpt.tag:http://reference.mrpt.org/devel//" href="http://reference.mrpt.org/devel/memory_8h.html#ae8980bd7f8c37e72ce7763c5d94f0076">MRPT_MAKE_ALIGNED_OPERATOR_NEW</a>  <span class="comment">// Required by Eigen containers</span>
<a name="l00816"></a>00816     }; <span class="comment">// end of class &quot;RbaEngine&quot;</span>
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 } <span class="comment">// end of namespace &quot;srba&quot;</span>
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="comment">// -----------------------------------------------------------------</span>
<a name="l00822"></a>00822 <span class="comment">//          Include all template implementation files</span>
<a name="l00823"></a>00823 <span class="comment">// -----------------------------------------------------------------</span>
<a name="l00824"></a>00824 <span class="preprocessor">#include &quot;impl/add-observations.h&quot;</span>
<a name="l00825"></a>00825 <span class="preprocessor">#include &quot;impl/alloc_keyframe.h&quot;</span>
<a name="l00826"></a>00826 <span class="preprocessor">#include &quot;impl/alloc_kf2kf_edge.h&quot;</span>
<a name="l00827"></a>00827 <span class="preprocessor">#include &quot;impl/create_kf2kf_edge.h&quot;</span>
<a name="l00828"></a>00828 <span class="preprocessor">#include &quot;impl/define_new_keyframe.h&quot;</span>
<a name="l00829"></a>00829 <span class="preprocessor">#include &quot;impl/jacobians.h&quot;</span>
<a name="l00830"></a>00830 <span class="preprocessor">#include &quot;impl/rba_problem_common.h&quot;</span>
<a name="l00831"></a>00831 <span class="preprocessor">#include &quot;impl/schur.h&quot;</span>
<a name="l00832"></a>00832 <span class="preprocessor">#include &quot;impl/sparse_hessian_build_symbolic.h&quot;</span>
<a name="l00833"></a>00833 <span class="preprocessor">#include &quot;impl/sparse_hessian_update_numeric.h&quot;</span>
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 <span class="preprocessor">#include &quot;impl/spantree_create_complete.h&quot;</span>
<a name="l00836"></a>00836 <span class="preprocessor">#include &quot;impl/spantree_update_symbolic.h&quot;</span>
<a name="l00837"></a>00837 <span class="preprocessor">#include &quot;impl/spantree_update_numeric.h&quot;</span>
<a name="l00838"></a>00838 <span class="preprocessor">#include &quot;impl/spantree_misc.h&quot;</span>
<a name="l00839"></a>00839 <span class="preprocessor">#include &quot;impl/jacobians.h&quot;</span>
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="preprocessor">#include &quot;impl/export_opengl.h&quot;</span>
<a name="l00842"></a>00842 <span class="preprocessor">#include &quot;impl/export_dot.h&quot;</span>
<a name="l00843"></a>00843 <span class="preprocessor">#include &quot;impl/get_global_graphslam_problem.h&quot;</span>
<a name="l00844"></a>00844 <span class="preprocessor">#include &quot;impl/eval_overall_error.h&quot;</span>
<a name="l00845"></a>00845 <span class="preprocessor">#include &quot;impl/determine_kf2kf_edges_to_create.h&quot;</span>
<a name="l00846"></a>00846 <span class="preprocessor">#include &quot;impl/reprojection_residuals.h&quot;</span>
<a name="l00847"></a>00847 <span class="preprocessor">#include &quot;impl/compute_minus_gradient.h&quot;</span>
<a name="l00848"></a>00848 <span class="preprocessor">#include &quot;impl/optimize_edges.h&quot;</span>
<a name="l00849"></a>00849 <span class="preprocessor">#include &quot;impl/lev-marq_solvers.h&quot;</span>
<a name="l00850"></a>00850 <span class="preprocessor">#include &quot;impl/bfs_visitor.h&quot;</span>
<a name="l00851"></a>00851 <span class="preprocessor">#include &quot;impl/optimize_local_area.h&quot;</span>
<a name="l00852"></a>00852 <span class="comment">// -----------------------------------------------------------------</span>
<a name="l00853"></a>00853 <span class="comment">//            ^^ End of implementation files ^^</span>
<a name="l00854"></a>00854 <span class="comment">// -----------------------------------------------------------------</span>
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 <span class="comment">// Undefine temporary macro for verbose output</span>
<a name="l00857"></a>00857 <span class="preprocessor">#undef VERBOSE_LEVEL</span>
<a name="l00858"></a>00858 <span class="preprocessor"></span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->


<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 13 2016 10:45:20 for SRBA: Sparser Relative Bundle Adjustment by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="$relpath^doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>


<script type="text/javascript">
var sc_project=10707328; 
var sc_invisible=1; 
var sc_security="34dd40cf"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web statistics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/10707328/0/34dd40cf/1/"
alt="web statistics"></a></div></noscript>

</body>
</html>
